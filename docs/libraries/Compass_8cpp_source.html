<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>APM:Libraries: libraries/AP_Compass/Compass.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">APM:Libraries
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_bc0718b08fb2015b8e59c47b2805f60c.html">libraries</a></li><li class="navelem"><a class="el" href="dir_65717d02e6482fd400ba81c154f53df4.html">AP_Compass</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Compass.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="Compass_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="AP__HAL_8h.html">AP_HAL.h</a>&gt;</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="AP__Progmem_8h.html">AP_Progmem.h</a>&gt;</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Compass_8h.html">Compass.h</a>&quot;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="AP__Vehicle_8h.html">AP_Vehicle.h</a>&gt;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="keyword">extern</span> <a class="code" href="classAP__HAL_1_1HAL.html">AP_HAL::HAL</a>&amp; <a class="code" href="Compass_8cpp.html#a603431ff967752376822ef02ccd506a4">hal</a>;</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#if APM_BUILD_TYPE(APM_BUILD_ArduCopter)</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define COMPASS_LEARN_DEFAULT 0</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#else</span></div>
<div class="line"><a name="l00012"></a><span class="lineno"><a class="line" href="Compass_8cpp.html#abbd00be969534e4587e3479da3759384">   12</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define COMPASS_LEARN_DEFAULT 1</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00015"></a><span class="lineno"><a class="line" href="Compass_8cpp.html#af49b89e99b6382ee70c34569edb08337">   15</a></span>&#160;<span class="keyword">const</span> <a class="code" href="structAP__Param_1_1GroupInfo.html">AP_Param::GroupInfo</a> <a class="code" href="classCompass.html#a4a521c1c40cc45c4fe7c3e5680168ec7">Compass::var_info</a>[] <a class="code" href="Compass_8cpp.html#af49b89e99b6382ee70c34569edb08337">PROGMEM</a> = {</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    <span class="comment">// index 0 was used for the old orientation matrix</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    <span class="comment">// @Param: OFS_X</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <span class="comment">// @DisplayName: Compass offsets on the X axis</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    <span class="comment">// @Description: Offset to be added to the compass x-axis values to compensate for metal in the frame</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <span class="comment">// @Range: -400 400</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <span class="comment">// @Increment: 1</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <span class="comment">// @Param: OFS_Y</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <span class="comment">// @DisplayName: Compass offsets on the Y axis</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <span class="comment">// @Description: Offset to be added to the compass y-axis values to compensate for metal in the frame</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <span class="comment">// @Range: -400 400</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="comment">// @Increment: 1</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="comment">// @Param: OFS_Z</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="comment">// @DisplayName: Compass offsets on the Z axis</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="comment">// @Description: Offset to be added to the compass z-axis values to compensate for metal in the frame</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="comment">// @Range: -400 400</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="comment">// @Increment: 1</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <a class="code" href="AP__Param_8h.html#abe1c2a65ce5455bf37f3c000b4241c00">AP_GROUPINFO</a>(<span class="stringliteral">&quot;OFS&quot;</span>,    1, <a class="code" href="classCompass.html">Compass</a>, _state[0].offset, 0),</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="comment">// @Param: DEC</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="comment">// @DisplayName: Compass declination</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="comment">// @Description: An angle to compensate between the true north and magnetic north</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="comment">// @Range: -3.142 3.142</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="comment">// @Units: Radians</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="comment">// @Increment: 0.01</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="comment">// @User: Standard</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <a class="code" href="AP__Param_8h.html#abe1c2a65ce5455bf37f3c000b4241c00">AP_GROUPINFO</a>(<span class="stringliteral">&quot;DEC&quot;</span>,    2, <a class="code" href="classCompass.html">Compass</a>, _declination, 0),</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="comment">// @Param: LEARN</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="comment">// @DisplayName: Learn compass offsets automatically</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="comment">// @Description: Enable or disable the automatic learning of compass offsets</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="comment">// @Values: 0:Disabled,1:Enabled</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="comment">// @User: Advanced</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <a class="code" href="AP__Param_8h.html#abe1c2a65ce5455bf37f3c000b4241c00">AP_GROUPINFO</a>(<span class="stringliteral">&quot;LEARN&quot;</span>,  3, <a class="code" href="classCompass.html">Compass</a>, _learn, <a class="code" href="Compass_8cpp.html#abbd00be969534e4587e3479da3759384">COMPASS_LEARN_DEFAULT</a>),</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="comment">// @Param: USE</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="comment">// @DisplayName: Use compass for yaw</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="comment">// @Description: Enable or disable the use of the compass (instead of the GPS) for determining heading</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="comment">// @Values: 0:Disabled,1:Enabled</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="comment">// @User: Advanced</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <a class="code" href="AP__Param_8h.html#abe1c2a65ce5455bf37f3c000b4241c00">AP_GROUPINFO</a>(<span class="stringliteral">&quot;USE&quot;</span>,    4, <a class="code" href="classCompass.html">Compass</a>, _state[0].use_for_yaw, 1), <span class="comment">// true if used for DCM yaw</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">#if !defined( __AVR_ATmega1280__ )</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="preprocessor"></span>    <span class="comment">// @Param: AUTODEC</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="comment">// @DisplayName: Auto Declination</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="comment">// @Description: Enable or disable the automatic calculation of the declination based on gps location</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="comment">// @Values: 0:Disabled,1:Enabled</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="comment">// @User: Advanced</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <a class="code" href="AP__Param_8h.html#abe1c2a65ce5455bf37f3c000b4241c00">AP_GROUPINFO</a>(<span class="stringliteral">&quot;AUTODEC&quot;</span>,5, <a class="code" href="classCompass.html">Compass</a>, _auto_declination, 1),</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="comment">// @Param: MOTCT</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="comment">// @DisplayName: Motor interference compensation type</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="comment">// @Description: Set motor interference compensation type to disabled, throttle or current.  Do not change manually.</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="comment">// @Values: 0:Disabled,1:Use Throttle,2:Use Current</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="comment">// @Increment: 1</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <a class="code" href="AP__Param_8h.html#abe1c2a65ce5455bf37f3c000b4241c00">AP_GROUPINFO</a>(<span class="stringliteral">&quot;MOTCT&quot;</span>,    6, <a class="code" href="classCompass.html">Compass</a>, _motor_comp_type, <a class="code" href="Compass_8h.html#aea476312c9a32f19ab3a0d62f4027869">AP_COMPASS_MOT_COMP_DISABLED</a>),</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="comment">// @Param: MOT_X</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="comment">// @DisplayName: Motor interference compensation for body frame X axis</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="comment">// @Description: Multiplied by the current throttle and added to the compass&#39;s x-axis values to compensate for motor interference</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="comment">// @Range: -1000 1000</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="comment">// @Units: Offset per Amp or at Full Throttle</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="comment">// @Increment: 1</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="comment">// @Param: MOT_Y</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="comment">// @DisplayName: Motor interference compensation for body frame Y axis</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="comment">// @Description: Multiplied by the current throttle and added to the compass&#39;s y-axis values to compensate for motor interference</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="comment">// @Range: -1000 1000</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="comment">// @Units: Offset per Amp or at Full Throttle</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="comment">// @Increment: 1</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="comment">// @Param: MOT_Z</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="comment">// @DisplayName: Motor interference compensation for body frame Z axis</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="comment">// @Description: Multiplied by the current throttle and added to the compass&#39;s z-axis values to compensate for motor interference</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="comment">// @Range: -1000 1000</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="comment">// @Units: Offset per Amp or at Full Throttle</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="comment">// @Increment: 1</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <a class="code" href="AP__Param_8h.html#abe1c2a65ce5455bf37f3c000b4241c00">AP_GROUPINFO</a>(<span class="stringliteral">&quot;MOT&quot;</span>,    7, <a class="code" href="classCompass.html">Compass</a>, _state[0].motor_compensation, 0),</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="comment">// @Param: ORIENT</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="comment">// @DisplayName: Compass orientation</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="comment">// @Description: The orientation of the compass relative to the autopilot board. This will default to the right value for each board type, but can be changed if you have an external compass. See the documentation for your external compass for the right value. The correct orientation should give the X axis forward, the Y axis to the right and the Z axis down. So if your aircraft is pointing west it should show a positive value for the Y axis, and a value close to zero for the X axis. On a PX4 or Pixhawk with an external compass the correct value is zero if the compass is correctly oriented. NOTE: This orientation is combined with any AHRS_ORIENTATION setting.</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="comment">// @Values: 0:None,1:Yaw45,2:Yaw90,3:Yaw135,4:Yaw180,5:Yaw225,6:Yaw270,7:Yaw315,8:Roll180,9:Roll180Yaw45,10:Roll180Yaw90,11:Roll180Yaw135,12:Pitch180,13:Roll180Yaw225,14:Roll180Yaw270,15:Roll180Yaw315,16:Roll90,17:Roll90Yaw45,18:Roll90Yaw90,19:Roll90Yaw135,20:Roll270,21:Roll270Yaw45,22:Roll270Yaw90,23:Roll270Yaw136,24:Pitch90,25:Pitch270,26:Pitch180Yaw90,27:Pitch180Yaw270,28:Roll90Pitch90,29:Roll180Pitch90,30:Roll270Pitch90,31:Roll90Pitch180,32:Roll270Pitch180,33:Roll90Pitch270,34:Roll180Pitch270,35:Roll270Pitch270,36:Roll90Pitch180Yaw90,37:Roll90Yaw270,38:Yaw293Pitch68Roll90</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <a class="code" href="AP__Param_8h.html#abe1c2a65ce5455bf37f3c000b4241c00">AP_GROUPINFO</a>(<span class="stringliteral">&quot;ORIENT&quot;</span>, 8, <a class="code" href="classCompass.html">Compass</a>, _state[0].orientation, <a class="code" href="rotations_8h.html#a4940d1dc528122726d2c8c475657e1a9a3c485d0686ff0555d4db0c22959f9dec">ROTATION_NONE</a>),</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="comment">// @Param: EXTERNAL</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="comment">// @DisplayName: Compass is attached via an external cable</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="comment">// @Description: Configure compass so it is attached externally. This is auto-detected on PX4 and Pixhawk, but must be set correctly on an APM2. Set to 1 if the compass is externally connected. When externally connected the COMPASS_ORIENT option operates independently of the AHRS_ORIENTATION board orientation option</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="comment">// @Values: 0:Internal,1:External</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="comment">// @User: Advanced</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <a class="code" href="AP__Param_8h.html#abe1c2a65ce5455bf37f3c000b4241c00">AP_GROUPINFO</a>(<span class="stringliteral">&quot;EXTERNAL&quot;</span>, 9, <a class="code" href="classCompass.html">Compass</a>, _state[0].external, 0),</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="preprocessor">#if COMPASS_MAX_INSTANCES &gt; 1</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="preprocessor"></span>    <span class="comment">// @Param: OFS2_X</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="comment">// @DisplayName: Compass2 offsets on the X axis</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="comment">// @Description: Offset to be added to compass2&#39;s x-axis values to compensate for metal in the frame</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="comment">// @Range: -400 400</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="comment">// @Increment: 1</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="comment">// @Param: OFS2_Y</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="comment">// @DisplayName: Compass2 offsets on the Y axis</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="comment">// @Description: Offset to be added to compass2&#39;s y-axis values to compensate for metal in the frame</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="comment">// @Range: -400 400</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="comment">// @Increment: 1</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="comment">// @Param: OFS2_Z</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="comment">// @DisplayName: Compass2 offsets on the Z axis</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="comment">// @Description: Offset to be added to compass2&#39;s z-axis values to compensate for metal in the frame</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="comment">// @Range: -400 400</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="comment">// @Increment: 1</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <a class="code" href="AP__Param_8h.html#abe1c2a65ce5455bf37f3c000b4241c00">AP_GROUPINFO</a>(<span class="stringliteral">&quot;OFS2&quot;</span>,    10, <a class="code" href="classCompass.html">Compass</a>, _state[1].offset, 0),</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="comment">// @Param: MOT2_X</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="comment">// @DisplayName: Motor interference compensation to compass2 for body frame X axis</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="comment">// @Description: Multiplied by the current throttle and added to compass2&#39;s x-axis values to compensate for motor interference</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="comment">// @Range: -1000 1000</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="comment">// @Units: Offset per Amp or at Full Throttle</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="comment">// @Increment: 1</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="comment">// @Param: MOT2_Y</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="comment">// @DisplayName: Motor interference compensation to compass2 for body frame Y axis</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="comment">// @Description: Multiplied by the current throttle and added to compass2&#39;s y-axis values to compensate for motor interference</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="comment">// @Range: -1000 1000</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="comment">// @Units: Offset per Amp or at Full Throttle</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="comment">// @Increment: 1</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="comment">// @Param: MOT2_Z</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="comment">// @DisplayName: Motor interference compensation to compass2 for body frame Z axis</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="comment">// @Description: Multiplied by the current throttle and added to compass2&#39;s z-axis values to compensate for motor interference</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="comment">// @Range: -1000 1000</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="comment">// @Units: Offset per Amp or at Full Throttle</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="comment">// @Increment: 1</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <a class="code" href="AP__Param_8h.html#abe1c2a65ce5455bf37f3c000b4241c00">AP_GROUPINFO</a>(<span class="stringliteral">&quot;MOT2&quot;</span>,    11, <a class="code" href="classCompass.html">Compass</a>, _state[1].motor_compensation, 0),</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="comment">// @Param: PRIMARY</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="comment">// @DisplayName: Choose primary compass</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="comment">// @Description: If more than one compass is available this selects which compass is the primary. Normally 0=External, 1=Internal. If no External compass is attached this parameter is ignored</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="comment">// @Values: 0:FirstCompass,1:SecondCompass</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="comment">// @User: Advanced</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <a class="code" href="AP__Param_8h.html#abe1c2a65ce5455bf37f3c000b4241c00">AP_GROUPINFO</a>(<span class="stringliteral">&quot;PRIMARY&quot;</span>, 12, <a class="code" href="classCompass.html">Compass</a>, _primary, 0),</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="preprocessor">#if COMPASS_MAX_INSTANCES &gt; 2</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="preprocessor"></span>    <span class="comment">// @Param: OFS3_X</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="comment">// @DisplayName: Compass3 offsets on the X axis</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="comment">// @Description: Offset to be added to compass3&#39;s x-axis values to compensate for metal in the frame</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="comment">// @Range: -400 400</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="comment">// @Increment: 1</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="comment">// @Param: OFS3_Y</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="comment">// @DisplayName: Compass3 offsets on the Y axis</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="comment">// @Description: Offset to be added to compass3&#39;s y-axis values to compensate for metal in the frame</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="comment">// @Range: -400 400</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="comment">// @Increment: 1</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="comment">// @Param: OFS3_Z</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="comment">// @DisplayName: Compass3 offsets on the Z axis</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="comment">// @Description: Offset to be added to compass3&#39;s z-axis values to compensate for metal in the frame</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="comment">// @Range: -400 400</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="comment">// @Increment: 1</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <a class="code" href="AP__Param_8h.html#abe1c2a65ce5455bf37f3c000b4241c00">AP_GROUPINFO</a>(<span class="stringliteral">&quot;OFS3&quot;</span>,    13, <a class="code" href="classCompass.html">Compass</a>, _state[2].offset, 0),</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="comment">// @Param: MOT3_X</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="comment">// @DisplayName: Motor interference compensation to compass3 for body frame X axis</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="comment">// @Description: Multiplied by the current throttle and added to compass3&#39;s x-axis values to compensate for motor interference</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="comment">// @Range: -1000 1000</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="comment">// @Units: Offset per Amp or at Full Throttle</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="comment">// @Increment: 1</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="comment">// @Param: MOT3_Y</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="comment">// @DisplayName: Motor interference compensation to compass3 for body frame Y axis</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="comment">// @Description: Multiplied by the current throttle and added to compass3&#39;s y-axis values to compensate for motor interference</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="comment">// @Range: -1000 1000</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="comment">// @Units: Offset per Amp or at Full Throttle</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="comment">// @Increment: 1</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="comment">// @Param: MOT3_Z</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="comment">// @DisplayName: Motor interference compensation to compass3 for body frame Z axis</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="comment">// @Description: Multiplied by the current throttle and added to compass3&#39;s z-axis values to compensate for motor interference</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="comment">// @Range: -1000 1000</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="comment">// @Units: Offset per Amp or at Full Throttle</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="comment">// @Increment: 1</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <a class="code" href="AP__Param_8h.html#abe1c2a65ce5455bf37f3c000b4241c00">AP_GROUPINFO</a>(<span class="stringliteral">&quot;MOT3&quot;</span>,    14, <a class="code" href="classCompass.html">Compass</a>, _state[2].motor_compensation, 0),</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="preprocessor">#if COMPASS_MAX_INSTANCES &gt; 1</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="preprocessor"></span>    <span class="comment">// @Param: DEV_ID</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="comment">// @DisplayName: Compass device id</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="comment">// @Description: Compass device id.  Automatically detected, do not set manually</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="comment">// @User: Advanced</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <a class="code" href="AP__Param_8h.html#abe1c2a65ce5455bf37f3c000b4241c00">AP_GROUPINFO</a>(<span class="stringliteral">&quot;DEV_ID&quot;</span>,  15, <a class="code" href="classCompass.html">Compass</a>, _state[0].dev_id, 0),</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="comment">// @Param: DEV_ID2</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="comment">// @DisplayName: Compass2 device id</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="comment">// @Description: Second compass&#39;s device id.  Automatically detected, do not set manually</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="comment">// @User: Advanced</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <a class="code" href="AP__Param_8h.html#abe1c2a65ce5455bf37f3c000b4241c00">AP_GROUPINFO</a>(<span class="stringliteral">&quot;DEV_ID2&quot;</span>, 16, <a class="code" href="classCompass.html">Compass</a>, _state[1].dev_id, 0),</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="preprocessor">#if COMPASS_MAX_INSTANCES &gt; 2</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="preprocessor"></span>    <span class="comment">// @Param: DEV_ID3</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="comment">// @DisplayName: Compass3 device id</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="comment">// @Description: Third compass&#39;s device id.  Automatically detected, do not set manually</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="comment">// @User: Advanced</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <a class="code" href="AP__Param_8h.html#abe1c2a65ce5455bf37f3c000b4241c00">AP_GROUPINFO</a>(<span class="stringliteral">&quot;DEV_ID3&quot;</span>, 17, <a class="code" href="classCompass.html">Compass</a>, _state[2].dev_id, 0),</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="preprocessor">#if COMPASS_MAX_INSTANCES &gt; 1</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="preprocessor"></span>    <span class="comment">// @Param: USE2</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="comment">// @DisplayName: Compass2 used for yaw</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="comment">// @Description: Enable or disable the second compass for determining heading.</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="comment">// @Values: 0:Disabled,1:Enabled</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="comment">// @User: Advanced</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <a class="code" href="AP__Param_8h.html#abe1c2a65ce5455bf37f3c000b4241c00">AP_GROUPINFO</a>(<span class="stringliteral">&quot;USE2&quot;</span>,    18, <a class="code" href="classCompass.html">Compass</a>, _state[1].use_for_yaw, 1),</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="comment">// @Param: ORIENT2</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="comment">// @DisplayName: Compass2 orientation</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="comment">// @Description: The orientation of the second compass relative to the frame (if external) or autopilot board (if internal).</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="comment">// @Values: 0:None,1:Yaw45,2:Yaw90,3:Yaw135,4:Yaw180,5:Yaw225,6:Yaw270,7:Yaw315,8:Roll180,9:Roll180Yaw45,10:Roll180Yaw90,11:Roll180Yaw135,12:Pitch180,13:Roll180Yaw225,14:Roll180Yaw270,15:Roll180Yaw315,16:Roll90,17:Roll90Yaw45,18:Roll90Yaw90,19:Roll90Yaw135,20:Roll270,21:Roll270Yaw45,22:Roll270Yaw90,23:Roll270Yaw136,24:Pitch90,25:Pitch270,26:Pitch180Yaw90,27:Pitch180Yaw270,28:Roll90Pitch90,29:Roll180Pitch90,30:Roll270Pitch90,31:Roll90Pitch180,32:Roll270Pitch180,33:Roll90Pitch270,34:Roll180Pitch270,35:Roll270Pitch270,36:Roll90Pitch180Yaw90,37:Roll90Yaw270,38:Yaw293Pitch68Roll90</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <a class="code" href="AP__Param_8h.html#abe1c2a65ce5455bf37f3c000b4241c00">AP_GROUPINFO</a>(<span class="stringliteral">&quot;ORIENT2&quot;</span>, 19, <a class="code" href="classCompass.html">Compass</a>, _state[1].orientation, <a class="code" href="rotations_8h.html#a4940d1dc528122726d2c8c475657e1a9a3c485d0686ff0555d4db0c22959f9dec">ROTATION_NONE</a>),</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="comment">// @Param: EXTERN2</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="comment">// @DisplayName: Compass2 is attached via an external cable</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="comment">// @Description: Configure second compass so it is attached externally. This is auto-detected on PX4 and Pixhawk.</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="comment">// @Values: 0:Internal,1:External</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="comment">// @User: Advanced</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <a class="code" href="AP__Param_8h.html#abe1c2a65ce5455bf37f3c000b4241c00">AP_GROUPINFO</a>(<span class="stringliteral">&quot;EXTERN2&quot;</span>,20, <a class="code" href="classCompass.html">Compass</a>, _state[1].external, 0),</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="preprocessor">#if COMPASS_MAX_INSTANCES &gt; 2</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="preprocessor"></span>    <span class="comment">// @Param: USE3</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="comment">// @DisplayName: Compass3 used for yaw</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="comment">// @Description: Enable or disable the third compass for determining heading.</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="comment">// @Values: 0:Disabled,1:Enabled</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="comment">// @User: Advanced</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <a class="code" href="AP__Param_8h.html#abe1c2a65ce5455bf37f3c000b4241c00">AP_GROUPINFO</a>(<span class="stringliteral">&quot;USE3&quot;</span>,    21, <a class="code" href="classCompass.html">Compass</a>, _state[2].use_for_yaw, 1),</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="comment">// @Param: ORIENT3</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="comment">// @DisplayName: Compass3 orientation</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="comment">// @Description: The orientation of the third compass relative to the frame (if external) or autopilot board (if internal).</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="comment">// @Values: 0:None,1:Yaw45,2:Yaw90,3:Yaw135,4:Yaw180,5:Yaw225,6:Yaw270,7:Yaw315,8:Roll180,9:Roll180Yaw45,10:Roll180Yaw90,11:Roll180Yaw135,12:Pitch180,13:Roll180Yaw225,14:Roll180Yaw270,15:Roll180Yaw315,16:Roll90,17:Roll90Yaw45,18:Roll90Yaw90,19:Roll90Yaw135,20:Roll270,21:Roll270Yaw45,22:Roll270Yaw90,23:Roll270Yaw136,24:Pitch90,25:Pitch270,26:Pitch180Yaw90,27:Pitch180Yaw270,28:Roll90Pitch90,29:Roll180Pitch90,30:Roll270Pitch90,31:Roll90Pitch180,32:Roll270Pitch180,33:Roll90Pitch270,34:Roll180Pitch270,35:Roll270Pitch270,36:Roll90Pitch180Yaw90,37:Roll90Yaw270,38:Yaw293Pitch68Roll90</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <a class="code" href="AP__Param_8h.html#abe1c2a65ce5455bf37f3c000b4241c00">AP_GROUPINFO</a>(<span class="stringliteral">&quot;ORIENT3&quot;</span>, 22, <a class="code" href="classCompass.html">Compass</a>, _state[2].orientation, <a class="code" href="rotations_8h.html#a4940d1dc528122726d2c8c475657e1a9a3c485d0686ff0555d4db0c22959f9dec">ROTATION_NONE</a>),</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="comment">// @Param: EXTERN3</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="comment">// @DisplayName: Compass3 is attached via an external cable</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="comment">// @Description: Configure third compass so it is attached externally. This is auto-detected on PX4 and Pixhawk.</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="comment">// @Values: 0:Internal,1:External</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="comment">// @User: Advanced</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <a class="code" href="AP__Param_8h.html#abe1c2a65ce5455bf37f3c000b4241c00">AP_GROUPINFO</a>(<span class="stringliteral">&quot;EXTERN3&quot;</span>,23, <a class="code" href="classCompass.html">Compass</a>, _state[2].external, 0),</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <a class="code" href="AP__Param_8h.html#a0f9acb038a5283b964b862aea8cc5051">AP_GROUPEND</a></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;};</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">// Default constructor.</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">// Note that the Vector/Matrix constructors already implicitly zero</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">// their values.</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00277"></a><span class="lineno"><a class="line" href="classCompass.html#a68bd2a073cc0d461b2b46529aae04765">  277</a></span>&#160;<a class="code" href="classCompass.html#a68bd2a073cc0d461b2b46529aae04765">Compass::Compass</a>(<span class="keywordtype">void</span>) :</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    _last_update_usec(0),</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    _backend_count(0),</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    _compass_count(0),</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    _board_orientation(<a class="code" href="rotations_8h.html#a4940d1dc528122726d2c8c475657e1a9a3c485d0686ff0555d4db0c22959f9dec">ROTATION_NONE</a>),</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    _null_init_done(false),</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    _thr_or_curr(0.0<a class="code" href="DerivativeFilter_8cpp.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>),</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    _hil_mode(false)</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;{</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <a class="code" href="classAP__Param.html#a5f6dcfce1c0a79cf5bd81283e22f3201">AP_Param::setup_object_defaults</a>(<span class="keyword">this</span>, <a class="code" href="classCompass.html#a4a521c1c40cc45c4fe7c3e5680168ec7">var_info</a>);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keywordflow">for</span> (uint8_t <a class="code" href="GCS__Console_2examples_2Console_2Console_8pde.html#acb559820d9ca11295b4500f179ef6392">i</a>=0; <a class="code" href="GCS__Console_2examples_2Console_2Console_8pde.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;<a class="code" href="Compass_8h.html#a5ae256887a80a65f39d06f1cb2cbfacb">COMPASS_MAX_BACKEND</a>; <a class="code" href="GCS__Console_2examples_2Console_2Console_8pde.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        <a class="code" href="classCompass.html#af46d67cb8eb4bc4c51bb12be6813cfdd">_backends</a>[<a class="code" href="GCS__Console_2examples_2Console_2Console_8pde.html#acb559820d9ca11295b4500f179ef6392">i</a>] = NULL;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    }    </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="preprocessor">#if COMPASS_MAX_INSTANCES &gt; 1</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="preprocessor"></span>    <span class="comment">// default device ids to zero.  init() method will overwrite with the actual device ids</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="keywordflow">for</span> (uint8_t <a class="code" href="GCS__Console_2examples_2Console_2Console_8pde.html#acb559820d9ca11295b4500f179ef6392">i</a>=0; <a class="code" href="GCS__Console_2examples_2Console_2Console_8pde.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;<a class="code" href="Compass_8h.html#a0a6a0f28d3465747ea15e7d9091994de">COMPASS_MAX_INSTANCES</a>; <a class="code" href="GCS__Console_2examples_2Console_2Console_8pde.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        <a class="code" href="classCompass.html#aa953947e6a3d5acc0504e3f7c1e6b61d">_state</a>[<a class="code" href="GCS__Console_2examples_2Console_2Console_8pde.html#acb559820d9ca11295b4500f179ef6392">i</a>].dev_id = 0;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    }</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="preprocessor"></span>}</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">// Default init method</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="keywordtype">bool</span></div>
<div class="line"><a name="l00302"></a><span class="lineno"><a class="line" href="classCompass.html#a190aefc281aba88c7b16e4fc58035c5e">  302</a></span>&#160;<a class="code" href="classCompass.html#a190aefc281aba88c7b16e4fc58035c5e">Compass::init</a>()</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;{</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classCompass.html#afd52e3b95b4813b56a79742c0d98e6e4">_compass_count</a> == 0) {</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        <span class="comment">// detect available backends. Only called once</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        <a class="code" href="classCompass.html#a1c48170d8c8966b22fb150b1634443ec">_detect_backends</a>();</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    }</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classCompass.html#afd52e3b95b4813b56a79742c0d98e6e4">_compass_count</a> != 0) {</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        <span class="comment">// get initial health status</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        hal.<a class="code" href="classAP__HAL_1_1HAL.html#a94ab41309b1ff10b8b862b826e59c882">scheduler</a>-&gt;<a class="code" href="classAP__HAL_1_1Scheduler.html#ab3175e2e6223ccfe82f957e41cc12b26">delay</a>(100);</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        <a class="code" href="classCompass.html#a2593e947a6c8a4937dccd2d367158b74">read</a>();</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    }</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;}</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">//  Register a new compass instance</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00318"></a><span class="lineno"><a class="line" href="classCompass.html#af1b5ea3ff42b02e04526d4be361a1ca1">  318</a></span>&#160;uint8_t <a class="code" href="classCompass.html#af1b5ea3ff42b02e04526d4be361a1ca1">Compass::register_compass</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;{</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classCompass.html#afd52e3b95b4813b56a79742c0d98e6e4">_compass_count</a> == <a class="code" href="Compass_8h.html#a0a6a0f28d3465747ea15e7d9091994de">COMPASS_MAX_INSTANCES</a>) {</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        hal.<a class="code" href="classAP__HAL_1_1HAL.html#a94ab41309b1ff10b8b862b826e59c882">scheduler</a>-&gt;<a class="code" href="classAP__HAL_1_1Scheduler.html#a65f0d4e404d3e6fda4d8b0b101c9780f">panic</a>(<a class="code" href="AP__Progmem__AVR_8h.html#a05ca900ebf7cd121be73c654d9ccb3eb">PSTR</a>(<span class="stringliteral">&quot;Too many compass instances&quot;</span>));</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    }</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classCompass.html#afd52e3b95b4813b56a79742c0d98e6e4">_compass_count</a>++;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;}</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment">  try to load a backend</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="keywordtype">void</span> </div>
<div class="line"><a name="l00330"></a><span class="lineno"><a class="line" href="classCompass.html#a9e958fc87035f6afaccaceda983ad02a">  330</a></span>&#160;<a class="code" href="classCompass.html#a9e958fc87035f6afaccaceda983ad02a">Compass::_add_backend</a>(<a class="code" href="classAP__Compass__Backend.html">AP_Compass_Backend</a> *(detect)(<a class="code" href="classCompass.html">Compass</a> &amp;))</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;{</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classCompass.html#ac3bf8f6ab108927b2ea704b3dcba1355">_backend_count</a> == <a class="code" href="Compass_8h.html#a5ae256887a80a65f39d06f1cb2cbfacb">COMPASS_MAX_BACKEND</a>) {</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        hal.<a class="code" href="classAP__HAL_1_1HAL.html#a94ab41309b1ff10b8b862b826e59c882">scheduler</a>-&gt;<a class="code" href="classAP__HAL_1_1Scheduler.html#a65f0d4e404d3e6fda4d8b0b101c9780f">panic</a>(<a class="code" href="AP__Progmem__AVR_8h.html#a05ca900ebf7cd121be73c654d9ccb3eb">PSTR</a>(<span class="stringliteral">&quot;Too many compass backends&quot;</span>));</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    }</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <a class="code" href="classCompass.html#af46d67cb8eb4bc4c51bb12be6813cfdd">_backends</a>[<a class="code" href="classCompass.html#ac3bf8f6ab108927b2ea704b3dcba1355">_backend_count</a>] = detect(*<span class="keyword">this</span>);</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classCompass.html#af46d67cb8eb4bc4c51bb12be6813cfdd">_backends</a>[<a class="code" href="classCompass.html#ac3bf8f6ab108927b2ea704b3dcba1355">_backend_count</a>] != NULL) {</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <a class="code" href="classCompass.html#ac3bf8f6ab108927b2ea704b3dcba1355">_backend_count</a>++;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    }</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;}</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">  detect available backends for this board</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="keywordtype">void</span> </div>
<div class="line"><a name="l00345"></a><span class="lineno"><a class="line" href="classCompass.html#a1c48170d8c8966b22fb150b1634443ec">  345</a></span>&#160;<a class="code" href="classCompass.html#a1c48170d8c8966b22fb150b1634443ec">Compass::_detect_backends</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;{</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classCompass.html#a26a6c969c9e588fb680b04e99edbe811">_hil_mode</a>) {</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        <a class="code" href="classCompass.html#a9e958fc87035f6afaccaceda983ad02a">_add_backend</a>(<a class="code" href="classAP__Compass__HIL.html#ae4ae94f11b8c05de50076d85fbcef0f1">AP_Compass_HIL::detect</a>);</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    }</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="preprocessor">#if CONFIG_HAL_BOARD == HAL_BOARD_LINUX &amp;&amp; CONFIG_HAL_BOARD_SUBTYPE != HAL_BOARD_SUBTYPE_LINUX_NONE</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="preprocessor"></span>    <a class="code" href="classCompass.html#a9e958fc87035f6afaccaceda983ad02a">_add_backend</a>(<a class="code" href="classAP__Compass__HMC5843.html#a24c7d88a8f69532e40f96c5a0db25364">AP_Compass_HMC5843::detect</a>);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <a class="code" href="classCompass.html#a9e958fc87035f6afaccaceda983ad02a">_add_backend</a>(<a class="code" href="classAP__Compass__AK8963__MPU9250.html#a6276a40d516ecd31513c02ecf84a666f">AP_Compass_AK8963_MPU9250::detect</a>);</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="preprocessor">#elif HAL_COMPASS_DEFAULT == HAL_COMPASS_HIL</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="preprocessor"></span>    <a class="code" href="classCompass.html#a9e958fc87035f6afaccaceda983ad02a">_add_backend</a>(<a class="code" href="classAP__Compass__HIL.html#ae4ae94f11b8c05de50076d85fbcef0f1">AP_Compass_HIL::detect</a>);</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="preprocessor">#elif HAL_COMPASS_DEFAULT == HAL_COMPASS_HMC5843</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="preprocessor"></span>    <a class="code" href="classCompass.html#a9e958fc87035f6afaccaceda983ad02a">_add_backend</a>(<a class="code" href="classAP__Compass__HMC5843.html#a24c7d88a8f69532e40f96c5a0db25364">AP_Compass_HMC5843::detect</a>);</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="preprocessor">#elif HAL_COMPASS_DEFAULT == HAL_COMPASS_PX4 || HAL_COMPASS_DEFAULT == HAL_COMPASS_VRBRAIN</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="preprocessor"></span>    <a class="code" href="classCompass.html#a9e958fc87035f6afaccaceda983ad02a">_add_backend</a>(<a class="code" href="classAP__Compass__PX4.html#a31f9519f4a0c078771749e2bce1dd988">AP_Compass_PX4::detect</a>);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="preprocessor">#elif HAL_COMPASS_DEFAULT == HAL_COMPASS_AK8963_MPU9250</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="preprocessor"></span>    <a class="code" href="classCompass.html#a9e958fc87035f6afaccaceda983ad02a">_add_backend</a>(<a class="code" href="classAP__Compass__AK8963__MPU9250.html#a6276a40d516ecd31513c02ecf84a666f">AP_Compass_AK8963_MPU9250::detect</a>);</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="preprocessor"></span><span class="preprocessor">    #error Unrecognised HAL_COMPASS_TYPE setting</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classCompass.html#ac3bf8f6ab108927b2ea704b3dcba1355">_backend_count</a> == 0 ||</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        <a class="code" href="classCompass.html#afd52e3b95b4813b56a79742c0d98e6e4">_compass_count</a> == 0) {</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        hal.<a class="code" href="classAP__HAL_1_1HAL.html#a94ab41309b1ff10b8b862b826e59c882">scheduler</a>-&gt;<a class="code" href="classAP__HAL_1_1Scheduler.html#a65f0d4e404d3e6fda4d8b0b101c9780f">panic</a>(<a class="code" href="AP__Progmem__AVR_8h.html#a05ca900ebf7cd121be73c654d9ccb3eb">PSTR</a>(<span class="stringliteral">&quot;No Compass backends available&quot;</span>));</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    }</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;}</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="keywordtype">void</span> </div>
<div class="line"><a name="l00374"></a><span class="lineno"><a class="line" href="classCompass.html#aa3372aa51bd41b1d3ee3a9234a4396a0">  374</a></span>&#160;<a class="code" href="classCompass.html#aa3372aa51bd41b1d3ee3a9234a4396a0">Compass::accumulate</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;{    </div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="keywordflow">for</span> (uint8_t <a class="code" href="GCS__Console_2examples_2Console_2Console_8pde.html#acb559820d9ca11295b4500f179ef6392">i</a>=0; <a class="code" href="GCS__Console_2examples_2Console_2Console_8pde.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt; <a class="code" href="classCompass.html#ac3bf8f6ab108927b2ea704b3dcba1355">_backend_count</a>; <a class="code" href="GCS__Console_2examples_2Console_2Console_8pde.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        <span class="comment">// call accumulate on each of the backend</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        <a class="code" href="classCompass.html#af46d67cb8eb4bc4c51bb12be6813cfdd">_backends</a>[<a class="code" href="GCS__Console_2examples_2Console_2Console_8pde.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;<a class="code" href="classAP__Compass__Backend.html#a7212725ed935362caf3884123995d193">accumulate</a>();</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    }</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;}</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="keywordtype">bool</span> </div>
<div class="line"><a name="l00383"></a><span class="lineno"><a class="line" href="classCompass.html#a2593e947a6c8a4937dccd2d367158b74">  383</a></span>&#160;<a class="code" href="classCompass.html#a2593e947a6c8a4937dccd2d367158b74">Compass::read</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;{</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="keywordflow">for</span> (uint8_t <a class="code" href="GCS__Console_2examples_2Console_2Console_8pde.html#acb559820d9ca11295b4500f179ef6392">i</a>=0; <a class="code" href="GCS__Console_2examples_2Console_2Console_8pde.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt; <a class="code" href="classCompass.html#ac3bf8f6ab108927b2ea704b3dcba1355">_backend_count</a>; <a class="code" href="GCS__Console_2examples_2Console_2Console_8pde.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        <span class="comment">// call read on each of the backend. This call updates field[i]</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        <a class="code" href="classCompass.html#af46d67cb8eb4bc4c51bb12be6813cfdd">_backends</a>[<a class="code" href="GCS__Console_2examples_2Console_2Console_8pde.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;<a class="code" href="classAP__Compass__Backend.html#a4ad0e616103be3703829b829ab590a53">read</a>();</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    }    </div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="keywordflow">for</span> (uint8_t <a class="code" href="GCS__Console_2examples_2Console_2Console_8pde.html#acb559820d9ca11295b4500f179ef6392">i</a>=0; <a class="code" href="GCS__Console_2examples_2Console_2Console_8pde.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="Compass_8h.html#a0a6a0f28d3465747ea15e7d9091994de">COMPASS_MAX_INSTANCES</a>; <a class="code" href="GCS__Console_2examples_2Console_2Console_8pde.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        <a class="code" href="classCompass.html#aa953947e6a3d5acc0504e3f7c1e6b61d">_state</a>[<a class="code" href="GCS__Console_2examples_2Console_2Console_8pde.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="structCompass_1_1mag__state.html#ad12e4054ec35030309b98a799e9f0df4">healthy</a> = (hal.<a class="code" href="classAP__HAL_1_1HAL.html#a94ab41309b1ff10b8b862b826e59c882">scheduler</a>-&gt;<a class="code" href="classAP__HAL_1_1Scheduler.html#a26b68339fc68a562d8d3a1238d0ec8c1">millis</a>() - <a class="code" href="classCompass.html#aa953947e6a3d5acc0504e3f7c1e6b61d">_state</a>[<a class="code" href="GCS__Console_2examples_2Console_2Console_8pde.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="structCompass_1_1mag__state.html#a37a5242ab675b8bdf0ce4246e03c5729">last_update_ms</a> &lt; 500);</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    }</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classCompass.html#a3be4f1bd3056c7c0d97226f58e9f32f0">healthy</a>();</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;}</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00396"></a><span class="lineno"><a class="line" href="classCompass.html#a18ec405430e055e4a01912a8ca73cbc3">  396</a></span>&#160;<a class="code" href="classCompass.html#a18ec405430e055e4a01912a8ca73cbc3">Compass::set_offsets</a>(uint8_t <a class="code" href="GCS__Console_2examples_2Console_2Console_8pde.html#acb559820d9ca11295b4500f179ef6392">i</a>, <span class="keyword">const</span> <a class="code" href="classVector3.html">Vector3f</a> &amp;offsets)</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;{</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <span class="comment">// sanity check compass instance provided</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="keywordflow">if</span> (i &lt; <a class="code" href="Compass_8h.html#a0a6a0f28d3465747ea15e7d9091994de">COMPASS_MAX_INSTANCES</a>) {</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        <a class="code" href="classCompass.html#aa953947e6a3d5acc0504e3f7c1e6b61d">_state</a>[<a class="code" href="GCS__Console_2examples_2Console_2Console_8pde.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="structCompass_1_1mag__state.html#a3e2ff88eb37ae470b4c1b4b3c232305e">offset</a>.set(offsets);</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    }</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;}</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00405"></a><span class="lineno"><a class="line" href="classCompass.html#afeac6bcfad2650762cccda72dbce3e69">  405</a></span>&#160;<a class="code" href="classCompass.html#afeac6bcfad2650762cccda72dbce3e69">Compass::set_and_save_offsets</a>(uint8_t <a class="code" href="GCS__Console_2examples_2Console_2Console_8pde.html#acb559820d9ca11295b4500f179ef6392">i</a>, <span class="keyword">const</span> <a class="code" href="classVector3.html">Vector3f</a> &amp;offsets)</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;{</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="comment">// sanity check compass instance provided</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="keywordflow">if</span> (i &lt; <a class="code" href="Compass_8h.html#a0a6a0f28d3465747ea15e7d9091994de">COMPASS_MAX_INSTANCES</a>) {</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        <a class="code" href="classCompass.html#aa953947e6a3d5acc0504e3f7c1e6b61d">_state</a>[<a class="code" href="GCS__Console_2examples_2Console_2Console_8pde.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="structCompass_1_1mag__state.html#a3e2ff88eb37ae470b4c1b4b3c232305e">offset</a>.set(offsets);</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        <a class="code" href="classCompass.html#abfc394b43272d5a6e97001232e201b7f">save_offsets</a>(i);</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    }</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;}</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00415"></a><span class="lineno"><a class="line" href="classCompass.html#a95f3b4686f214914703c321c9c8e9df2">  415</a></span>&#160;<a class="code" href="classCompass.html#abfc394b43272d5a6e97001232e201b7f">Compass::save_offsets</a>(uint8_t <a class="code" href="GCS__Console_2examples_2Console_2Console_8pde.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;{</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <a class="code" href="classCompass.html#aa953947e6a3d5acc0504e3f7c1e6b61d">_state</a>[<a class="code" href="GCS__Console_2examples_2Console_2Console_8pde.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="structCompass_1_1mag__state.html#a3e2ff88eb37ae470b4c1b4b3c232305e">offset</a>.save();  <span class="comment">// save offsets</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="preprocessor">#if COMPASS_MAX_INSTANCES &gt; 1</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="preprocessor"></span>    <a class="code" href="classCompass.html#aa953947e6a3d5acc0504e3f7c1e6b61d">_state</a>[<a class="code" href="GCS__Console_2examples_2Console_2Console_8pde.html#acb559820d9ca11295b4500f179ef6392">i</a>].dev_id.save();  <span class="comment">// save device id corresponding to these offsets</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="preprocessor"></span>}</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00424"></a><span class="lineno"><a class="line" href="classCompass.html#abfc394b43272d5a6e97001232e201b7f">  424</a></span>&#160;<a class="code" href="classCompass.html#abfc394b43272d5a6e97001232e201b7f">Compass::save_offsets</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;{</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="keywordflow">for</span> (uint8_t <a class="code" href="GCS__Console_2examples_2Console_2Console_8pde.html#acb559820d9ca11295b4500f179ef6392">i</a>=0; <a class="code" href="GCS__Console_2examples_2Console_2Console_8pde.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;<a class="code" href="Compass_8h.html#a0a6a0f28d3465747ea15e7d9091994de">COMPASS_MAX_INSTANCES</a>; <a class="code" href="GCS__Console_2examples_2Console_2Console_8pde.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        <a class="code" href="classCompass.html#abfc394b43272d5a6e97001232e201b7f">save_offsets</a>(<a class="code" href="GCS__Console_2examples_2Console_2Console_8pde.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    }</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;}</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00432"></a><span class="lineno"><a class="line" href="classCompass.html#a307ba851d14fd2ac3b655227812f6b4d">  432</a></span>&#160;<a class="code" href="classCompass.html#a307ba851d14fd2ac3b655227812f6b4d">Compass::set_motor_compensation</a>(uint8_t <a class="code" href="GCS__Console_2examples_2Console_2Console_8pde.html#acb559820d9ca11295b4500f179ef6392">i</a>, <span class="keyword">const</span> <a class="code" href="classVector3.html">Vector3f</a> &amp;motor_comp_factor)</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;{</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <a class="code" href="classCompass.html#aa953947e6a3d5acc0504e3f7c1e6b61d">_state</a>[<a class="code" href="GCS__Console_2examples_2Console_2Console_8pde.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="structCompass_1_1mag__state.html#a90887b7c30ed529dc3fecfb36729f9d7">motor_compensation</a>.set(motor_comp_factor);</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;}</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00438"></a><span class="lineno"><a class="line" href="classCompass.html#adeefda110ce0a02edfb3d344d632777a">  438</a></span>&#160;<a class="code" href="classCompass.html#adeefda110ce0a02edfb3d344d632777a">Compass::save_motor_compensation</a>()</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;{</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <a class="code" href="classCompass.html#a53de8105fdd000b28afe20ced1b85d5a">_motor_comp_type</a>.save();</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <span class="keywordflow">for</span> (uint8_t k=0; k&lt;<a class="code" href="Compass_8h.html#a0a6a0f28d3465747ea15e7d9091994de">COMPASS_MAX_INSTANCES</a>; k++) {</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        <a class="code" href="classCompass.html#aa953947e6a3d5acc0504e3f7c1e6b61d">_state</a>[k].<a class="code" href="structCompass_1_1mag__state.html#a90887b7c30ed529dc3fecfb36729f9d7">motor_compensation</a>.save();</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    }</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;}</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00447"></a><span class="lineno"><a class="line" href="classCompass.html#a95d49517b12183412d9d0ed481b785bf">  447</a></span>&#160;<a class="code" href="classCompass.html#a95d49517b12183412d9d0ed481b785bf">Compass::set_initial_location</a>(int32_t latitude, int32_t longitude)</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;{</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <span class="comment">// if automatic declination is configured, then compute</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="comment">// the declination based on the initial GPS fix</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classCompass.html#a92a1e23d7ff2ade9024f2145e4e8d0a2">_auto_declination</a>) {</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        <span class="comment">// Set the declination based on the lat/lng from GPS</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        <a class="code" href="classCompass.html#a424b78025887b128dd21833cb6e31d0b">_declination</a>.set(<a class="code" href="AP__Math_8cpp.html#aa3adb05231060d239e5b91940e001f85">radians</a>(</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                <a class="code" href="classAP__Declination.html#a8819112a0ea684422948a1ae8bc4f0de">AP_Declination::get_declination</a>(</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                    (<span class="keywordtype">float</span>)latitude / 10000000,</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                    (<span class="keywordtype">float</span>)longitude / 10000000)));</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    }</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;}</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="keywordtype">bool</span></div>
<div class="line"><a name="l00462"></a><span class="lineno"><a class="line" href="classCompass.html#ac47b570ae40bfba56a659c5ac766a464">  462</a></span>&#160;<a class="code" href="classCompass.html#ac47b570ae40bfba56a659c5ac766a464">Compass::use_for_yaw</a>(<span class="keywordtype">void</span>)<span class="keyword"> const</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    uint8_t prim = <a class="code" href="classCompass.html#a0120c84cc915d5a34aafedc1ce3f5186">get_primary</a>();</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classCompass.html#a3be4f1bd3056c7c0d97226f58e9f32f0">healthy</a>(prim) &amp;&amp; <a class="code" href="classCompass.html#ac47b570ae40bfba56a659c5ac766a464">use_for_yaw</a>(prim);</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;}</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="keywordtype">bool</span></div>
<div class="line"><a name="l00470"></a><span class="lineno"><a class="line" href="classCompass.html#a97437729a583cd900e4dd1d6d84a4a0e">  470</a></span>&#160;<a class="code" href="classCompass.html#ac47b570ae40bfba56a659c5ac766a464">Compass::use_for_yaw</a>(uint8_t <a class="code" href="GCS__Console_2examples_2Console_2Console_8pde.html#acb559820d9ca11295b4500f179ef6392">i</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classCompass.html#aa953947e6a3d5acc0504e3f7c1e6b61d">_state</a>[<a class="code" href="GCS__Console_2examples_2Console_2Console_8pde.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="structCompass_1_1mag__state.html#a49545b0efc480dbab4a518321a708dc1">use_for_yaw</a>;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;}</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00476"></a><span class="lineno"><a class="line" href="classCompass.html#ac3584d30eca4e60567613c1b09785505">  476</a></span>&#160;<a class="code" href="classCompass.html#ac3584d30eca4e60567613c1b09785505">Compass::set_declination</a>(<span class="keywordtype">float</span> <a class="code" href="AP__Math_8cpp.html#aa3adb05231060d239e5b91940e001f85">radians</a>, <span class="keywordtype">bool</span> save_to_eeprom)</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;{</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="keywordflow">if</span> (save_to_eeprom) {</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        <a class="code" href="classCompass.html#a424b78025887b128dd21833cb6e31d0b">_declination</a>.set_and_save(radians);</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        <a class="code" href="classCompass.html#a424b78025887b128dd21833cb6e31d0b">_declination</a>.set(radians);</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    }</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;}</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="keywordtype">float</span></div>
<div class="line"><a name="l00486"></a><span class="lineno"><a class="line" href="classCompass.html#a5051de1d15ee203600422235ab93c88c">  486</a></span>&#160;<a class="code" href="classCompass.html#a5051de1d15ee203600422235ab93c88c">Compass::get_declination</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classCompass.html#a424b78025887b128dd21833cb6e31d0b">_declination</a>.get();</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;}</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="comment">  calculate a compass heading given the attitude from DCM and the mag vector</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="keywordtype">float</span></div>
<div class="line"><a name="l00495"></a><span class="lineno"><a class="line" href="classCompass.html#aeef734d2cd69c8c0c3efa182ec7f80bb">  495</a></span>&#160;<a class="code" href="classCompass.html#aeef734d2cd69c8c0c3efa182ec7f80bb">Compass::calculate_heading</a>(<span class="keyword">const</span> <a class="code" href="classMatrix3.html">Matrix3f</a> &amp;dcm_matrix)<span class="keyword"> const</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="keywordtype">float</span> cos_pitch_sq = 1.0f-(dcm_matrix.<a class="code" href="classMatrix3.html#a7efa0e7bd4c621a7fe76cd9168960b94">c</a>.<a class="code" href="classVector3.html#a1a0f7e168c71ca798099f0ba8a444244">x</a>*dcm_matrix.<a class="code" href="classMatrix3.html#a7efa0e7bd4c621a7fe76cd9168960b94">c</a>.<a class="code" href="classVector3.html#a1a0f7e168c71ca798099f0ba8a444244">x</a>);</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="comment">// Tilt compensated magnetic field Y component:</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <span class="keyword">const</span> <a class="code" href="classVector3.html">Vector3f</a> &amp;<a class="code" href="classCompass.html#a0a8d322a3774f60f4c1577dad3ab016a">field</a> = <a class="code" href="classCompass.html#a22ce936207eeda5d3fa55237271cef3e">get_field</a>();</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <span class="keywordtype">float</span> headY = field.<a class="code" href="classVector3.html#a561df88b28e106e337a25bb86554a569">y</a> * dcm_matrix.<a class="code" href="classMatrix3.html#a7efa0e7bd4c621a7fe76cd9168960b94">c</a>.<a class="code" href="classVector3.html#ab3e7f5401dd6e951978bfa746809f74f">z</a> - field.<a class="code" href="classVector3.html#ab3e7f5401dd6e951978bfa746809f74f">z</a> * dcm_matrix.<a class="code" href="classMatrix3.html#a7efa0e7bd4c621a7fe76cd9168960b94">c</a>.<a class="code" href="classVector3.html#a561df88b28e106e337a25bb86554a569">y</a>;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <span class="comment">// Tilt compensated magnetic field X component:</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <span class="keywordtype">float</span> headX = field.<a class="code" href="classVector3.html#a1a0f7e168c71ca798099f0ba8a444244">x</a> * cos_pitch_sq - dcm_matrix.<a class="code" href="classMatrix3.html#a7efa0e7bd4c621a7fe76cd9168960b94">c</a>.<a class="code" href="classVector3.html#a1a0f7e168c71ca798099f0ba8a444244">x</a> * (field.<a class="code" href="classVector3.html#a561df88b28e106e337a25bb86554a569">y</a> * dcm_matrix.<a class="code" href="classMatrix3.html#a7efa0e7bd4c621a7fe76cd9168960b94">c</a>.<a class="code" href="classVector3.html#a561df88b28e106e337a25bb86554a569">y</a> + field.<a class="code" href="classVector3.html#ab3e7f5401dd6e951978bfa746809f74f">z</a> * dcm_matrix.<a class="code" href="classMatrix3.html#a7efa0e7bd4c621a7fe76cd9168960b94">c</a>.<a class="code" href="classVector3.html#ab3e7f5401dd6e951978bfa746809f74f">z</a>);</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <span class="comment">// magnetic heading</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="comment">// 6/4/11 - added constrain to keep bad values from ruining DCM Yaw - Jason S.</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="keywordtype">float</span> heading = <a class="code" href="AP__Math_8cpp.html#a08eedb329d8162ddbd344d4f6c8cde20">constrain_float</a>(<a class="code" href="AP__Math__AVR__Compat_8h.html#ae31ff8b5990823ebb5d9746cc0843293">atan2f</a>(-headY,headX), -3.15<a class="code" href="DerivativeFilter_8cpp.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>, 3.15<a class="code" href="DerivativeFilter_8cpp.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>);</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="comment">// Declination correction (if supplied)</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="AP__Math__AVR__Compat_8h.html#a3745ca949b1ef9df47fb2f52c2536e68">fabsf</a>(<a class="code" href="classCompass.html#a424b78025887b128dd21833cb6e31d0b">_declination</a>) &gt; 0.0<a class="code" href="DerivativeFilter_8cpp.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a> )</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    {</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        heading = heading + <a class="code" href="classCompass.html#a424b78025887b128dd21833cb6e31d0b">_declination</a>;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        <span class="keywordflow">if</span> (heading &gt; <a class="code" href="AP__Math_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a>)    <span class="comment">// Angle normalization (-180 deg, 180 deg)</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;            heading -= (2.0f * <a class="code" href="AP__Math_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a>);</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (heading &lt; -<a class="code" href="AP__Math_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a>)</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;            heading += (2.0f * <a class="code" href="AP__Math_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a>);</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    }</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <span class="keywordflow">return</span> heading;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;}</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;</div>
<div class="line"><a name="l00528"></a><span class="lineno"><a class="line" href="classCompass.html#a59622e8195dc29485f24d7c27a9cf7f0">  528</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classCompass.html#a1479c75532bc97308b1c698b67cf9bcc">Compass::configured</a>(uint8_t <a class="code" href="GCS__Console_2examples_2Console_2Console_8pde.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;{</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="comment">// exit immediately if instance is beyond the number of compasses we have available</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="keywordflow">if</span> (i &gt; <a class="code" href="classCompass.html#a7bc9b45433e47cbd2632578388882135">get_count</a>()) {</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    }</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <span class="comment">// exit immediately if all offsets are zero</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="AP__Math_8h.html#a108b79eeb35c5d58f324458ec9e1e9f2">is_zero</a>(<a class="code" href="classCompass.html#a46431b5638dd088dd4a09026109544f2">get_offsets</a>(i).length())) {</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    }</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="preprocessor">#if COMPASS_MAX_INSTANCES &gt; 1</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="preprocessor"></span>    <span class="comment">// backup detected dev_id</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    int32_t dev_id_orig = <a class="code" href="classCompass.html#aa953947e6a3d5acc0504e3f7c1e6b61d">_state</a>[<a class="code" href="GCS__Console_2examples_2Console_2Console_8pde.html#acb559820d9ca11295b4500f179ef6392">i</a>].dev_id;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <span class="comment">// load dev_id from eeprom</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    <a class="code" href="classCompass.html#aa953947e6a3d5acc0504e3f7c1e6b61d">_state</a>[<a class="code" href="GCS__Console_2examples_2Console_2Console_8pde.html#acb559820d9ca11295b4500f179ef6392">i</a>].dev_id.load();</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <span class="comment">// if different then the device has not been configured</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classCompass.html#aa953947e6a3d5acc0504e3f7c1e6b61d">_state</a>[i].dev_id != dev_id_orig) {</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        <span class="comment">// restore device id</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        <a class="code" href="classCompass.html#aa953947e6a3d5acc0504e3f7c1e6b61d">_state</a>[<a class="code" href="GCS__Console_2examples_2Console_2Console_8pde.html#acb559820d9ca11295b4500f179ef6392">i</a>].dev_id = dev_id_orig;</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        <span class="comment">// return failure</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    }</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <span class="comment">// if we got here then it must be configured</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;}</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;</div>
<div class="line"><a name="l00560"></a><span class="lineno"><a class="line" href="classCompass.html#a1479c75532bc97308b1c698b67cf9bcc">  560</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classCompass.html#a1479c75532bc97308b1c698b67cf9bcc">Compass::configured</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;{</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <span class="keywordtype">bool</span> all_configured = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <span class="keywordflow">for</span>(uint8_t <a class="code" href="GCS__Console_2examples_2Console_2Console_8pde.html#acb559820d9ca11295b4500f179ef6392">i</a>=0; <a class="code" href="GCS__Console_2examples_2Console_2Console_8pde.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;<a class="code" href="classCompass.html#a7bc9b45433e47cbd2632578388882135">get_count</a>(); <a class="code" href="GCS__Console_2examples_2Console_2Console_8pde.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        all_configured = all_configured &amp;&amp; <a class="code" href="classCompass.html#a1479c75532bc97308b1c698b67cf9bcc">configured</a>(<a class="code" href="GCS__Console_2examples_2Console_2Console_8pde.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    }</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <span class="keywordflow">return</span> all_configured;</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;}</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="comment">// Update raw magnetometer values from HIL data</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00571"></a><span class="lineno"><a class="line" href="classCompass.html#a30a8fa22b1e7ee8eec8143732d40716d">  571</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classCompass.html#a30a8fa22b1e7ee8eec8143732d40716d">Compass::setHIL</a>(uint8_t instance, <span class="keywordtype">float</span> roll, <span class="keywordtype">float</span> pitch, <span class="keywordtype">float</span> yaw)</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;{</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <a class="code" href="classMatrix3.html">Matrix3f</a> R;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <span class="comment">// create a rotation matrix for the given attitude</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    R.<a class="code" href="classMatrix3.html#a62587bd216436f09f06b9e1330f84bc0">from_euler</a>(roll, pitch, yaw);</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="AP__Math_8h.html#acedd05d9f5ab6f2878991cc684e17c18">is_equal</a>(<a class="code" href="classCompass.html#a3c0f008f3766d88885b3c0893fe11d76">_hil</a>.last_declination,<a class="code" href="classCompass.html#a5051de1d15ee203600422235ab93c88c">get_declination</a>())) {</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        <a class="code" href="classCompass.html#a0bc30e897c2c0c412120e1b1337bd1cb">_setup_earth_field</a>();</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        <a class="code" href="classCompass.html#a3c0f008f3766d88885b3c0893fe11d76">_hil</a>.last_declination = <a class="code" href="classCompass.html#a5051de1d15ee203600422235ab93c88c">get_declination</a>();</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    }</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <span class="comment">// convert the earth frame magnetic vector to body frame, and</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    <span class="comment">// apply the offsets</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    <a class="code" href="classCompass.html#a3c0f008f3766d88885b3c0893fe11d76">_hil</a>.field[instance] = R.<a class="code" href="classMatrix3.html#a3705734aec6b67d729011cd792d7398a">mul_transpose</a>(<a class="code" href="classCompass.html#a3c0f008f3766d88885b3c0893fe11d76">_hil</a>.Bearth);</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <span class="comment">// apply default board orientation for this compass type. This is</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <span class="comment">// a noop on most boards</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <a class="code" href="classCompass.html#a3c0f008f3766d88885b3c0893fe11d76">_hil</a>.field[instance].rotate(<a class="code" href="Compass_8h.html#aa61c5cc48785eef1f5b2143fa77a50e7">MAG_BOARD_ORIENTATION</a>);</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    <span class="comment">// add user selectable orientation</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    <a class="code" href="classCompass.html#a3c0f008f3766d88885b3c0893fe11d76">_hil</a>.field[instance].rotate((<span class="keyword">enum</span> <a class="code" href="rotations_8h.html#a4940d1dc528122726d2c8c475657e1a9">Rotation</a>)<a class="code" href="classCompass.html#aa953947e6a3d5acc0504e3f7c1e6b61d">_state</a>[0].orientation.get());</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classCompass.html#aa953947e6a3d5acc0504e3f7c1e6b61d">_state</a>[0].external) {</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        <span class="comment">// and add in AHRS_ORIENTATION setting if not an external compass</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        <a class="code" href="classCompass.html#a3c0f008f3766d88885b3c0893fe11d76">_hil</a>.field[instance].rotate(<a class="code" href="classCompass.html#a1d376552464c5c5792326561d063ef7e">_board_orientation</a>);</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    }</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    <a class="code" href="classCompass.html#a3c0f008f3766d88885b3c0893fe11d76">_hil</a>.healthy[instance] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;}</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="comment">// Update raw magnetometer values from HIL mag vector</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00603"></a><span class="lineno"><a class="line" href="classCompass.html#a851dd30dd8402db2956cbff36c450a0c">  603</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classCompass.html#a30a8fa22b1e7ee8eec8143732d40716d">Compass::setHIL</a>(uint8_t instance, <span class="keyword">const</span> <a class="code" href="classVector3.html">Vector3f</a> &amp;mag)</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;{</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    <a class="code" href="classCompass.html#a3c0f008f3766d88885b3c0893fe11d76">_hil</a>.field[instance] = mag;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <a class="code" href="classCompass.html#a3c0f008f3766d88885b3c0893fe11d76">_hil</a>.healthy[instance] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <a class="code" href="classCompass.html#aaea07d9da1c4836fdf1300845514e831">_last_update_usec</a> = hal.<a class="code" href="classAP__HAL_1_1HAL.html#a94ab41309b1ff10b8b862b826e59c882">scheduler</a>-&gt;<a class="code" href="classAP__HAL_1_1Scheduler.html#add46d722bfb08a16f220e63591654e46">micros</a>();</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;}</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;</div>
<div class="line"><a name="l00610"></a><span class="lineno"><a class="line" href="classCompass.html#a4d696bdfb4d2ab9f0646d413cb6a0ee4">  610</a></span>&#160;<span class="keyword">const</span> <a class="code" href="classVector3.html">Vector3f</a>&amp; <a class="code" href="classCompass.html#a4d696bdfb4d2ab9f0646d413cb6a0ee4">Compass::getHIL</a>(uint8_t instance)<span class="keyword"> const </span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classCompass.html#a3c0f008f3766d88885b3c0893fe11d76">_hil</a>.field[instance];</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;}</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="comment">// setup _Bearth</span></div>
<div class="line"><a name="l00616"></a><span class="lineno"><a class="line" href="classCompass.html#a0bc30e897c2c0c412120e1b1337bd1cb">  616</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classCompass.html#a0bc30e897c2c0c412120e1b1337bd1cb">Compass::_setup_earth_field</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;{</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    <span class="comment">// assume a earth field strength of 400</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    <a class="code" href="classCompass.html#a3c0f008f3766d88885b3c0893fe11d76">_hil</a>.Bearth(400, 0, 0);</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    </div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <span class="comment">// rotate _Bearth for inclination and declination. -66 degrees</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <span class="comment">// is the inclination in Canberra, Australia</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <a class="code" href="classMatrix3.html">Matrix3f</a> R;</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    R.<a class="code" href="classMatrix3.html#a62587bd216436f09f06b9e1330f84bc0">from_euler</a>(0, <a class="code" href="AP__Common_8h.html#a728f9499baea61e7df3ae70a374f2512">ToRad</a>(66), <a class="code" href="classCompass.html#a5051de1d15ee203600422235ab93c88c">get_declination</a>());</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    <a class="code" href="classCompass.html#a3c0f008f3766d88885b3c0893fe11d76">_hil</a>.Bearth = R * <a class="code" href="classCompass.html#a3c0f008f3766d88885b3c0893fe11d76">_hil</a>.Bearth;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;}</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="comment">  set the type of motor compensation to use</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00631"></a><span class="lineno"><a class="line" href="classCompass.html#ad897fd4be9dd67a65343465614629568">  631</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classCompass.html#ad897fd4be9dd67a65343465614629568">Compass::motor_compensation_type</a>(<span class="keyword">const</span> uint8_t comp_type)</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;{</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classCompass.html#a53de8105fdd000b28afe20ced1b85d5a">_motor_comp_type</a> &lt;= <a class="code" href="Compass_8h.html#aa22be79a45fb28cb3160eacdf5ad4432">AP_COMPASS_MOT_COMP_CURRENT</a> &amp;&amp; <a class="code" href="classCompass.html#a53de8105fdd000b28afe20ced1b85d5a">_motor_comp_type</a> != (int8_t)comp_type) {</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;        <a class="code" href="classCompass.html#a53de8105fdd000b28afe20ced1b85d5a">_motor_comp_type</a> = (int8_t)comp_type;</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;        <a class="code" href="classCompass.html#a6e03b3c0b3eb8e71581562f5054afad3">_thr_or_curr</a> = 0;                               <span class="comment">// set current current or throttle to zero</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;        <span class="keywordflow">for</span> (uint8_t <a class="code" href="GCS__Console_2examples_2Console_2Console_8pde.html#acb559820d9ca11295b4500f179ef6392">i</a>=0; <a class="code" href="GCS__Console_2examples_2Console_2Console_8pde.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;<a class="code" href="Compass_8h.html#a0a6a0f28d3465747ea15e7d9091994de">COMPASS_MAX_INSTANCES</a>; <a class="code" href="GCS__Console_2examples_2Console_2Console_8pde.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;            <a class="code" href="classCompass.html#a307ba851d14fd2ac3b655227812f6b4d">set_motor_compensation</a>(<a class="code" href="GCS__Console_2examples_2Console_2Console_8pde.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="vector3_8h.html#af345ad77ba5e240c7ab72b4b2077e754">Vector3f</a>(0,0,0)); <span class="comment">// clear out invalid compensation vectors</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;        }</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    }</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;}</div>
<div class="ttc" id="Compass_8cpp_html_a603431ff967752376822ef02ccd506a4"><div class="ttname"><a href="Compass_8cpp.html#a603431ff967752376822ef02ccd506a4">hal</a></div><div class="ttdeci">AP_HAL::HAL &amp; hal</div><div class="ttdoc">-*- tab-width: 4; Mode: C++; c-basic-offset: 4; indent-tabs-mode: nil -*- </div><div class="ttdef"><b>Definition:</b> <a href="AC__PID__test_8pde_source.html#l00041">AC_PID_test.pde:41</a></div></div>
<div class="ttc" id="structCompass_1_1mag__state_html_ad12e4054ec35030309b98a799e9f0df4"><div class="ttname"><a href="structCompass_1_1mag__state.html#ad12e4054ec35030309b98a799e9f0df4">Compass::mag_state::healthy</a></div><div class="ttdeci">bool healthy</div><div class="ttdef"><b>Definition:</b> <a href="Compass_8h_source.html#l00297">Compass.h:297</a></div></div>
<div class="ttc" id="classCompass_html_af1b5ea3ff42b02e04526d4be361a1ca1"><div class="ttname"><a href="classCompass.html#af1b5ea3ff42b02e04526d4be361a1ca1">Compass::register_compass</a></div><div class="ttdeci">uint8_t register_compass(void)</div><div class="ttdef"><b>Definition:</b> <a href="Compass_8cpp_source.html#l00318">Compass.cpp:318</a></div></div>
<div class="ttc" id="classCompass_html_a92a1e23d7ff2ade9024f2145e4e8d0a2"><div class="ttname"><a href="classCompass.html#a92a1e23d7ff2ade9024f2145e4e8d0a2">Compass::_auto_declination</a></div><div class="ttdeci">AP_Int8 _auto_declination</div><div class="ttdef"><b>Definition:</b> <a href="Compass_8h_source.html#l00280">Compass.h:280</a></div></div>
<div class="ttc" id="GCS__Console_2examples_2Console_2Console_8pde_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="GCS__Console_2examples_2Console_2Console_8pde.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="GCS__Console_2examples_2Console_2Console_8pde_source.html#l00061">Console.pde:61</a></div></div>
<div class="ttc" id="classCompass_html_a4a521c1c40cc45c4fe7c3e5680168ec7"><div class="ttname"><a href="classCompass.html#a4a521c1c40cc45c4fe7c3e5680168ec7">Compass::var_info</a></div><div class="ttdeci">static const struct AP_Param::GroupInfo var_info[]</div><div class="ttdef"><b>Definition:</b> <a href="Compass_8h_source.html#l00237">Compass.h:237</a></div></div>
<div class="ttc" id="classCompass_html_a68bd2a073cc0d461b2b46529aae04765"><div class="ttname"><a href="classCompass.html#a68bd2a073cc0d461b2b46529aae04765">Compass::Compass</a></div><div class="ttdeci">Compass()</div><div class="ttdef"><b>Definition:</b> <a href="Compass_8cpp_source.html#l00277">Compass.cpp:277</a></div></div>
<div class="ttc" id="classAP__Declination_html_a8819112a0ea684422948a1ae8bc4f0de"><div class="ttname"><a href="classAP__Declination.html#a8819112a0ea684422948a1ae8bc4f0de">AP_Declination::get_declination</a></div><div class="ttdeci">static float get_declination(float lat, float lon)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Declination_8cpp_source.html#l00121">AP_Declination.cpp:121</a></div></div>
<div class="ttc" id="classMatrix3_html_a3705734aec6b67d729011cd792d7398a"><div class="ttname"><a href="classMatrix3.html#a3705734aec6b67d729011cd792d7398a">Matrix3::mul_transpose</a></div><div class="ttdeci">Vector3&lt; T &gt; mul_transpose(const Vector3&lt; T &gt; &amp;v) const </div><div class="ttdef"><b>Definition:</b> <a href="matrix3_8cpp_source.html#l00152">matrix3.cpp:152</a></div></div>
<div class="ttc" id="classAP__HAL_1_1Scheduler_html_a26b68339fc68a562d8d3a1238d0ec8c1"><div class="ttname"><a href="classAP__HAL_1_1Scheduler.html#a26b68339fc68a562d8d3a1238d0ec8c1">AP_HAL::Scheduler::millis</a></div><div class="ttdeci">virtual uint32_t millis()=0</div></div>
<div class="ttc" id="Compass_8h_html_a0a6a0f28d3465747ea15e7d9091994de"><div class="ttname"><a href="Compass_8h.html#a0a6a0f28d3465747ea15e7d9091994de">COMPASS_MAX_INSTANCES</a></div><div class="ttdeci">#define COMPASS_MAX_INSTANCES</div><div class="ttdef"><b>Definition:</b> <a href="Compass_8h_source.html#l00042">Compass.h:42</a></div></div>
<div class="ttc" id="vector3_8h_html_af345ad77ba5e240c7ab72b4b2077e754"><div class="ttname"><a href="vector3_8h.html#af345ad77ba5e240c7ab72b4b2077e754">Vector3f</a></div><div class="ttdeci">Vector3&lt; float &gt; Vector3f</div><div class="ttdef"><b>Definition:</b> <a href="vector3_8h_source.html#l00219">vector3.h:219</a></div></div>
<div class="ttc" id="classAP__Compass__HIL_html_ae4ae94f11b8c05de50076d85fbcef0f1"><div class="ttname"><a href="classAP__Compass__HIL.html#ae4ae94f11b8c05de50076d85fbcef0f1">AP_Compass_HIL::detect</a></div><div class="ttdeci">static AP_Compass_Backend * detect(Compass &amp;compass)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass__HIL_8cpp_source.html#l00037">AP_Compass_HIL.cpp:37</a></div></div>
<div class="ttc" id="AP__HAL_8h_html"><div class="ttname"><a href="AP__HAL_8h.html">AP_HAL.h</a></div></div>
<div class="ttc" id="classCompass_html_a46431b5638dd088dd4a09026109544f2"><div class="ttname"><a href="classCompass.html#a46431b5638dd088dd4a09026109544f2">Compass::get_offsets</a></div><div class="ttdeci">const Vector3f &amp; get_offsets(void) const </div><div class="ttdef"><b>Definition:</b> <a href="Compass_8h_source.html#l00117">Compass.h:117</a></div></div>
<div class="ttc" id="classAP__Compass__PX4_html_a31f9519f4a0c078771749e2bce1dd988"><div class="ttname"><a href="classAP__Compass__PX4.html#a31f9519f4a0c078771749e2bce1dd988">AP_Compass_PX4::detect</a></div><div class="ttdeci">static AP_Compass_Backend * detect(Compass &amp;compass)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass__PX4_8cpp_source.html#l00052">AP_Compass_PX4.cpp:52</a></div></div>
<div class="ttc" id="AP__Param_8h_html_abe1c2a65ce5455bf37f3c000b4241c00"><div class="ttname"><a href="AP__Param_8h.html#abe1c2a65ce5455bf37f3c000b4241c00">AP_GROUPINFO</a></div><div class="ttdeci">#define AP_GROUPINFO(name, idx, class, element, def)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Param_8h_source.html#l00046">AP_Param.h:46</a></div></div>
<div class="ttc" id="classAP__Compass__Backend_html"><div class="ttname"><a href="classAP__Compass__Backend.html">AP_Compass_Backend</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass__Backend_8h_source.html#l00027">AP_Compass_Backend.h:27</a></div></div>
<div class="ttc" id="AP__Common_8h_html_a728f9499baea61e7df3ae70a374f2512"><div class="ttname"><a href="AP__Common_8h.html#a728f9499baea61e7df3ae70a374f2512">ToRad</a></div><div class="ttdeci">#define ToRad(x)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Common_8h_source.html#l00067">AP_Common.h:67</a></div></div>
<div class="ttc" id="classCompass_html_a30a8fa22b1e7ee8eec8143732d40716d"><div class="ttname"><a href="classCompass.html#a30a8fa22b1e7ee8eec8143732d40716d">Compass::setHIL</a></div><div class="ttdeci">void setHIL(uint8_t instance, float roll, float pitch, float yaw)</div><div class="ttdef"><b>Definition:</b> <a href="Compass_8cpp_source.html#l00571">Compass.cpp:571</a></div></div>
<div class="ttc" id="classCompass_html_a0120c84cc915d5a34aafedc1ce3f5186"><div class="ttname"><a href="classCompass.html#a0120c84cc915d5a34aafedc1ce3f5186">Compass::get_primary</a></div><div class="ttdeci">uint8_t get_primary(void) const </div><div class="ttdef"><b>Definition:</b> <a href="Compass_8h_source.html#l00223">Compass.h:223</a></div></div>
<div class="ttc" id="Compass_8cpp_html_af49b89e99b6382ee70c34569edb08337"><div class="ttname"><a href="Compass_8cpp.html#af49b89e99b6382ee70c34569edb08337">PROGMEM</a></div><div class="ttdeci">const AP_Param::GroupInfo Compass::var_info[] PROGMEM</div><div class="ttdef"><b>Definition:</b> <a href="Compass_8cpp_source.html#l00015">Compass.cpp:15</a></div></div>
<div class="ttc" id="classCompass_html_a190aefc281aba88c7b16e4fc58035c5e"><div class="ttname"><a href="classCompass.html#a190aefc281aba88c7b16e4fc58035c5e">Compass::init</a></div><div class="ttdeci">bool init()</div><div class="ttdef"><b>Definition:</b> <a href="Compass_8cpp_source.html#l00302">Compass.cpp:302</a></div></div>
<div class="ttc" id="classCompass_html_afeac6bcfad2650762cccda72dbce3e69"><div class="ttname"><a href="classCompass.html#afeac6bcfad2650762cccda72dbce3e69">Compass::set_and_save_offsets</a></div><div class="ttdeci">void set_and_save_offsets(uint8_t i, const Vector3f &amp;offsets)</div><div class="ttdef"><b>Definition:</b> <a href="Compass_8cpp_source.html#l00405">Compass.cpp:405</a></div></div>
<div class="ttc" id="classCompass_html_a6e03b3c0b3eb8e71581562f5054afad3"><div class="ttname"><a href="classCompass.html#a6e03b3c0b3eb8e71581562f5054afad3">Compass::_thr_or_curr</a></div><div class="ttdeci">float _thr_or_curr</div><div class="ttdef"><b>Definition:</b> <a href="Compass_8h_source.html#l00293">Compass.h:293</a></div></div>
<div class="ttc" id="classMatrix3_html"><div class="ttname"><a href="classMatrix3.html">Matrix3&lt; float &gt;</a></div></div>
<div class="ttc" id="classMatrix3_html_a62587bd216436f09f06b9e1330f84bc0"><div class="ttname"><a href="classMatrix3.html#a62587bd216436f09f06b9e1330f84bc0">Matrix3::from_euler</a></div><div class="ttdeci">void from_euler(float roll, float pitch, float yaw)</div><div class="ttdoc">-*- tab-width: 4; Mode: C++; c-basic-offset: 4; indent-tabs-mode: nil -*- </div><div class="ttdef"><b>Definition:</b> <a href="matrix3_8cpp_source.html#l00025">matrix3.cpp:25</a></div></div>
<div class="ttc" id="classCompass_html_aa3372aa51bd41b1d3ee3a9234a4396a0"><div class="ttname"><a href="classCompass.html#aa3372aa51bd41b1d3ee3a9234a4396a0">Compass::accumulate</a></div><div class="ttdeci">void accumulate()</div><div class="ttdef"><b>Definition:</b> <a href="Compass_8cpp_source.html#l00374">Compass.cpp:374</a></div></div>
<div class="ttc" id="classCompass_html_ac47b570ae40bfba56a659c5ac766a464"><div class="ttname"><a href="classCompass.html#ac47b570ae40bfba56a659c5ac766a464">Compass::use_for_yaw</a></div><div class="ttdeci">bool use_for_yaw(void) const </div><div class="ttdoc">return true if the compass should be used for yaw calculations </div><div class="ttdef"><b>Definition:</b> <a href="Compass_8cpp_source.html#l00462">Compass.cpp:462</a></div></div>
<div class="ttc" id="classCompass_html_a2593e947a6c8a4937dccd2d367158b74"><div class="ttname"><a href="classCompass.html#a2593e947a6c8a4937dccd2d367158b74">Compass::read</a></div><div class="ttdeci">bool read()</div><div class="ttdef"><b>Definition:</b> <a href="Compass_8cpp_source.html#l00383">Compass.cpp:383</a></div></div>
<div class="ttc" id="AP__Progmem_8h_html"><div class="ttname"><a href="AP__Progmem_8h.html">AP_Progmem.h</a></div></div>
<div class="ttc" id="classCompass_html_a424b78025887b128dd21833cb6e31d0b"><div class="ttname"><a href="classCompass.html#a424b78025887b128dd21833cb6e31d0b">Compass::_declination</a></div><div class="ttdeci">AP_Float _declination</div><div class="ttdef"><b>Definition:</b> <a href="Compass_8h_source.html#l00277">Compass.h:277</a></div></div>
<div class="ttc" id="classCompass_html_a18ec405430e055e4a01912a8ca73cbc3"><div class="ttname"><a href="classCompass.html#a18ec405430e055e4a01912a8ca73cbc3">Compass::set_offsets</a></div><div class="ttdeci">void set_offsets(uint8_t i, const Vector3f &amp;offsets)</div><div class="ttdef"><b>Definition:</b> <a href="Compass_8cpp_source.html#l00396">Compass.cpp:396</a></div></div>
<div class="ttc" id="classAP__HAL_1_1Scheduler_html_add46d722bfb08a16f220e63591654e46"><div class="ttname"><a href="classAP__HAL_1_1Scheduler.html#add46d722bfb08a16f220e63591654e46">AP_HAL::Scheduler::micros</a></div><div class="ttdeci">virtual uint32_t micros()=0</div></div>
<div class="ttc" id="classCompass_html_a307ba851d14fd2ac3b655227812f6b4d"><div class="ttname"><a href="classCompass.html#a307ba851d14fd2ac3b655227812f6b4d">Compass::set_motor_compensation</a></div><div class="ttdeci">void set_motor_compensation(uint8_t i, const Vector3f &amp;motor_comp_factor)</div><div class="ttdef"><b>Definition:</b> <a href="Compass_8cpp_source.html#l00432">Compass.cpp:432</a></div></div>
<div class="ttc" id="classCompass_html_a7bc9b45433e47cbd2632578388882135"><div class="ttname"><a href="classCompass.html#a7bc9b45433e47cbd2632578388882135">Compass::get_count</a></div><div class="ttdeci">uint8_t get_count(void) const </div><div class="ttdef"><b>Definition:</b> <a href="Compass_8h_source.html#l00102">Compass.h:102</a></div></div>
<div class="ttc" id="Compass_8h_html_a5ae256887a80a65f39d06f1cb2cbfacb"><div class="ttname"><a href="Compass_8h.html#a5ae256887a80a65f39d06f1cb2cbfacb">COMPASS_MAX_BACKEND</a></div><div class="ttdeci">#define COMPASS_MAX_BACKEND</div><div class="ttdef"><b>Definition:</b> <a href="Compass_8h_source.html#l00043">Compass.h:43</a></div></div>
<div class="ttc" id="classCompass_html_a0bc30e897c2c0c412120e1b1337bd1cb"><div class="ttname"><a href="classCompass.html#a0bc30e897c2c0c412120e1b1337bd1cb">Compass::_setup_earth_field</a></div><div class="ttdeci">void _setup_earth_field()</div><div class="ttdef"><b>Definition:</b> <a href="Compass_8cpp_source.html#l00616">Compass.cpp:616</a></div></div>
<div class="ttc" id="Compass_8h_html_aea476312c9a32f19ab3a0d62f4027869"><div class="ttname"><a href="Compass_8h.html#aea476312c9a32f19ab3a0d62f4027869">AP_COMPASS_MOT_COMP_DISABLED</a></div><div class="ttdeci">#define AP_COMPASS_MOT_COMP_DISABLED</div><div class="ttdef"><b>Definition:</b> <a href="Compass_8h_source.html#l00023">Compass.h:23</a></div></div>
<div class="ttc" id="classAP__HAL_1_1Scheduler_html_ab3175e2e6223ccfe82f957e41cc12b26"><div class="ttname"><a href="classAP__HAL_1_1Scheduler.html#ab3175e2e6223ccfe82f957e41cc12b26">AP_HAL::Scheduler::delay</a></div><div class="ttdeci">virtual void delay(uint16_t ms)=0</div></div>
<div class="ttc" id="classAP__HAL_1_1Scheduler_html_a65f0d4e404d3e6fda4d8b0b101c9780f"><div class="ttname"><a href="classAP__HAL_1_1Scheduler.html#a65f0d4e404d3e6fda4d8b0b101c9780f">AP_HAL::Scheduler::panic</a></div><div class="ttdeci">virtual void panic(const prog_char_t *errormsg)=0</div></div>
<div class="ttc" id="classCompass_html_a9e958fc87035f6afaccaceda983ad02a"><div class="ttname"><a href="classCompass.html#a9e958fc87035f6afaccaceda983ad02a">Compass::_add_backend</a></div><div class="ttdeci">void _add_backend(AP_Compass_Backend *(detect)(Compass &amp;))</div><div class="ttdef"><b>Definition:</b> <a href="Compass_8cpp_source.html#l00330">Compass.cpp:330</a></div></div>
<div class="ttc" id="classCompass_html_a5051de1d15ee203600422235ab93c88c"><div class="ttname"><a href="classCompass.html#a5051de1d15ee203600422235ab93c88c">Compass::get_declination</a></div><div class="ttdeci">float get_declination() const </div><div class="ttdef"><b>Definition:</b> <a href="Compass_8cpp_source.html#l00486">Compass.cpp:486</a></div></div>
<div class="ttc" id="AP__Math_8cpp_html_aa3adb05231060d239e5b91940e001f85"><div class="ttname"><a href="AP__Math_8cpp.html#aa3adb05231060d239e5b91940e001f85">radians</a></div><div class="ttdeci">float radians(float deg)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Math_8cpp_source.html#l00097">AP_Math.cpp:97</a></div></div>
<div class="ttc" id="AP__Math_8h_html_a598a3330b3c21701223ee0ca14316eca"><div class="ttname"><a href="AP__Math_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a></div><div class="ttdeci">#define PI</div><div class="ttdef"><b>Definition:</b> <a href="AP__Math_8h_source.html#l00032">AP_Math.h:32</a></div></div>
<div class="ttc" id="AP__Math__AVR__Compat_8h_html_a3745ca949b1ef9df47fb2f52c2536e68"><div class="ttname"><a href="AP__Math__AVR__Compat_8h.html#a3745ca949b1ef9df47fb2f52c2536e68">fabsf</a></div><div class="ttdeci">#define fabsf</div><div class="ttdef"><b>Definition:</b> <a href="AP__Math__AVR__Compat_8h_source.html#l00022">AP_Math_AVR_Compat.h:22</a></div></div>
<div class="ttc" id="classAP__HAL_1_1HAL_html"><div class="ttname"><a href="classAP__HAL_1_1HAL.html">AP_HAL::HAL</a></div><div class="ttdef"><b>Definition:</b> <a href="HAL_8h_source.html#l00015">HAL.h:15</a></div></div>
<div class="ttc" id="classAP__Compass__HMC5843_html_a24c7d88a8f69532e40f96c5a0db25364"><div class="ttname"><a href="classAP__Compass__HMC5843.html#a24c7d88a8f69532e40f96c5a0db25364">AP_Compass_HMC5843::detect</a></div><div class="ttdeci">static AP_Compass_Backend * detect(Compass &amp;compass)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass__HMC5843_8cpp_source.html#l00078">AP_Compass_HMC5843.cpp:78</a></div></div>
<div class="ttc" id="DerivativeFilter_8cpp_html_a357394e0f6f88c8a57bd893ab28dc8f8"><div class="ttname"><a href="DerivativeFilter_8cpp.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a></div><div class="ttdeci">#define f(i)</div></div>
<div class="ttc" id="classCompass_html"><div class="ttname"><a href="classCompass.html">Compass</a></div><div class="ttdef"><b>Definition:</b> <a href="Compass_8h_source.html#l00046">Compass.h:46</a></div></div>
<div class="ttc" id="classVector3_html_a561df88b28e106e337a25bb86554a569"><div class="ttname"><a href="classVector3.html#a561df88b28e106e337a25bb86554a569">Vector3::y</a></div><div class="ttdeci">T y</div><div class="ttdef"><b>Definition:</b> <a href="vector3_8h_source.html#l00070">vector3.h:70</a></div></div>
<div class="ttc" id="AP__Math_8h_html_acedd05d9f5ab6f2878991cc684e17c18"><div class="ttname"><a href="AP__Math_8h.html#acedd05d9f5ab6f2878991cc684e17c18">is_equal</a></div><div class="ttdeci">static bool is_equal(const float fVal1, const float fVal2)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Math_8h_source.html#l00080">AP_Math.h:80</a></div></div>
<div class="ttc" id="classMatrix3_html_a7efa0e7bd4c621a7fe76cd9168960b94"><div class="ttname"><a href="classMatrix3.html#a7efa0e7bd4c621a7fe76cd9168960b94">Matrix3::c</a></div><div class="ttdeci">Vector3&lt; T &gt; c</div><div class="ttdef"><b>Definition:</b> <a href="matrix3_8h_source.html#l00051">matrix3.h:51</a></div></div>
<div class="ttc" id="structCompass_1_1mag__state_html_a3e2ff88eb37ae470b4c1b4b3c232305e"><div class="ttname"><a href="structCompass_1_1mag__state.html#a3e2ff88eb37ae470b4c1b4b3c232305e">Compass::mag_state::offset</a></div><div class="ttdeci">AP_Vector3f offset</div><div class="ttdef"><b>Definition:</b> <a href="Compass_8h_source.html#l00299">Compass.h:299</a></div></div>
<div class="ttc" id="AP__Math_8h_html_a108b79eeb35c5d58f324458ec9e1e9f2"><div class="ttname"><a href="AP__Math_8h.html#a108b79eeb35c5d58f324458ec9e1e9f2">is_zero</a></div><div class="ttdeci">static bool is_zero(const float fVal1)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Math_8h_source.html#l00083">AP_Math.h:83</a></div></div>
<div class="ttc" id="classVector3_html_ab3e7f5401dd6e951978bfa746809f74f"><div class="ttname"><a href="classVector3.html#ab3e7f5401dd6e951978bfa746809f74f">Vector3::z</a></div><div class="ttdeci">T z</div><div class="ttdef"><b>Definition:</b> <a href="vector3_8h_source.html#l00070">vector3.h:70</a></div></div>
<div class="ttc" id="structAP__Param_1_1GroupInfo_html"><div class="ttname"><a href="structAP__Param_1_1GroupInfo.html">AP_Param::GroupInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__Param_8h_source.html#l00078">AP_Param.h:78</a></div></div>
<div class="ttc" id="classCompass_html_af46d67cb8eb4bc4c51bb12be6813cfdd"><div class="ttname"><a href="classCompass.html#af46d67cb8eb4bc4c51bb12be6813cfdd">Compass::_backends</a></div><div class="ttdeci">AP_Compass_Backend * _backends[COMPASS_MAX_BACKEND]</div><div class="ttdef"><b>Definition:</b> <a href="Compass_8h_source.html#l00261">Compass.h:261</a></div></div>
<div class="ttc" id="structCompass_1_1mag__state_html_a49545b0efc480dbab4a518321a708dc1"><div class="ttname"><a href="structCompass_1_1mag__state.html#a49545b0efc480dbab4a518321a708dc1">Compass::mag_state::use_for_yaw</a></div><div class="ttdeci">AP_Int8 use_for_yaw</div><div class="ttdef"><b>Definition:</b> <a href="Compass_8h_source.html#l00307">Compass.h:307</a></div></div>
<div class="ttc" id="classCompass_html_a22ce936207eeda5d3fa55237271cef3e"><div class="ttname"><a href="classCompass.html#a22ce936207eeda5d3fa55237271cef3e">Compass::get_field</a></div><div class="ttdeci">const Vector3f &amp; get_field(void) const </div><div class="ttdef"><b>Definition:</b> <a href="Compass_8h_source.html#l00106">Compass.h:106</a></div></div>
<div class="ttc" id="classCompass_html_a0a8d322a3774f60f4c1577dad3ab016a"><div class="ttname"><a href="classCompass.html#a0a8d322a3774f60f4c1577dad3ab016a">Compass::field</a></div><div class="ttdeci">Vector3f field[COMPASS_MAX_INSTANCES]</div><div class="ttdef"><b>Definition:</b> <a href="Compass_8h_source.html#l00244">Compass.h:244</a></div></div>
<div class="ttc" id="classCompass_html_a53de8105fdd000b28afe20ced1b85d5a"><div class="ttname"><a href="classCompass.html#a53de8105fdd000b28afe20ced1b85d5a">Compass::_motor_comp_type</a></div><div class="ttdeci">AP_Int8 _motor_comp_type</div><div class="ttdef"><b>Definition:</b> <a href="Compass_8h_source.html#l00290">Compass.h:290</a></div></div>
<div class="ttc" id="classCompass_html_a4d696bdfb4d2ab9f0646d413cb6a0ee4"><div class="ttname"><a href="classCompass.html#a4d696bdfb4d2ab9f0646d413cb6a0ee4">Compass::getHIL</a></div><div class="ttdeci">const Vector3f &amp; getHIL(uint8_t instance) const </div><div class="ttdef"><b>Definition:</b> <a href="Compass_8cpp_source.html#l00610">Compass.cpp:610</a></div></div>
<div class="ttc" id="classCompass_html_a1c48170d8c8966b22fb150b1634443ec"><div class="ttname"><a href="classCompass.html#a1c48170d8c8966b22fb150b1634443ec">Compass::_detect_backends</a></div><div class="ttdeci">void _detect_backends(void)</div><div class="ttdef"><b>Definition:</b> <a href="Compass_8cpp_source.html#l00345">Compass.cpp:345</a></div></div>
<div class="ttc" id="AP__Vehicle_8h_html"><div class="ttname"><a href="AP__Vehicle_8h.html">AP_Vehicle.h</a></div></div>
<div class="ttc" id="Compass_8h_html"><div class="ttname"><a href="Compass_8h.html">Compass.h</a></div></div>
<div class="ttc" id="classCompass_html_ac3584d30eca4e60567613c1b09785505"><div class="ttname"><a href="classCompass.html#ac3584d30eca4e60567613c1b09785505">Compass::set_declination</a></div><div class="ttdeci">void set_declination(float radians, bool save_to_eeprom=true)</div><div class="ttdef"><b>Definition:</b> <a href="Compass_8cpp_source.html#l00476">Compass.cpp:476</a></div></div>
<div class="ttc" id="classCompass_html_a26a6c969c9e588fb680b04e99edbe811"><div class="ttname"><a href="classCompass.html#a26a6c969c9e588fb680b04e99edbe811">Compass::_hil_mode</a></div><div class="ttdeci">bool _hil_mode</div><div class="ttdef"><b>Definition:</b> <a href="Compass_8h_source.html#l00326">Compass.h:326</a></div></div>
<div class="ttc" id="classCompass_html_ad897fd4be9dd67a65343465614629568"><div class="ttname"><a href="classCompass.html#ad897fd4be9dd67a65343465614629568">Compass::motor_compensation_type</a></div><div class="ttdeci">void motor_compensation_type(const uint8_t comp_type)</div><div class="ttdef"><b>Definition:</b> <a href="Compass_8cpp_source.html#l00631">Compass.cpp:631</a></div></div>
<div class="ttc" id="classAP__Compass__Backend_html_a7212725ed935362caf3884123995d193"><div class="ttname"><a href="classAP__Compass__Backend.html#a7212725ed935362caf3884123995d193">AP_Compass_Backend::accumulate</a></div><div class="ttdeci">virtual void accumulate(void)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass__Backend_8h_source.html#l00044">AP_Compass_Backend.h:44</a></div></div>
<div class="ttc" id="classAP__Compass__AK8963__MPU9250_html_a6276a40d516ecd31513c02ecf84a666f"><div class="ttname"><a href="classAP__Compass__AK8963__MPU9250.html#a6276a40d516ecd31513c02ecf84a666f">AP_Compass_AK8963_MPU9250::detect</a></div><div class="ttdeci">static AP_Compass_Backend * detect(Compass &amp;compass)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass__AK8963_8cpp_source.html#l00187">AP_Compass_AK8963.cpp:187</a></div></div>
<div class="ttc" id="classCompass_html_a3be4f1bd3056c7c0d97226f58e9f32f0"><div class="ttname"><a href="classCompass.html#a3be4f1bd3056c7c0d97226f58e9f32f0">Compass::healthy</a></div><div class="ttdeci">bool healthy(void) const </div><div class="ttdef"><b>Definition:</b> <a href="Compass_8h_source.html#l00110">Compass.h:110</a></div></div>
<div class="ttc" id="structCompass_1_1mag__state_html_a37a5242ab675b8bdf0ce4246e03c5729"><div class="ttname"><a href="structCompass_1_1mag__state.html#a37a5242ab675b8bdf0ce4246e03c5729">Compass::mag_state::last_update_ms</a></div><div class="ttdeci">uint32_t last_update_ms</div><div class="ttdef"><b>Definition:</b> <a href="Compass_8h_source.html#l00322">Compass.h:322</a></div></div>
<div class="ttc" id="classAP__Compass__Backend_html_a4ad0e616103be3703829b829ab590a53"><div class="ttname"><a href="classAP__Compass__Backend.html#a4ad0e616103be3703829b829ab590a53">AP_Compass_Backend::read</a></div><div class="ttdeci">virtual void read(void)=0</div></div>
<div class="ttc" id="AP__Math_8cpp_html_a08eedb329d8162ddbd344d4f6c8cde20"><div class="ttname"><a href="AP__Math_8cpp.html#a08eedb329d8162ddbd344d4f6c8cde20">constrain_float</a></div><div class="ttdeci">float constrain_float(float amt, float low, float high)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Math_8cpp_source.html#l00074">AP_Math.cpp:74</a></div></div>
<div class="ttc" id="classCompass_html_afd52e3b95b4813b56a79742c0d98e6e4"><div class="ttname"><a href="classCompass.html#afd52e3b95b4813b56a79742c0d98e6e4">Compass::_compass_count</a></div><div class="ttdeci">uint8_t _compass_count</div><div class="ttdef"><b>Definition:</b> <a href="Compass_8h_source.html#l00265">Compass.h:265</a></div></div>
<div class="ttc" id="Compass_8cpp_html_abbd00be969534e4587e3479da3759384"><div class="ttname"><a href="Compass_8cpp.html#abbd00be969534e4587e3479da3759384">COMPASS_LEARN_DEFAULT</a></div><div class="ttdeci">#define COMPASS_LEARN_DEFAULT</div><div class="ttdef"><b>Definition:</b> <a href="Compass_8cpp_source.html#l00012">Compass.cpp:12</a></div></div>
<div class="ttc" id="Compass_8h_html_aa22be79a45fb28cb3160eacdf5ad4432"><div class="ttname"><a href="Compass_8h.html#aa22be79a45fb28cb3160eacdf5ad4432">AP_COMPASS_MOT_COMP_CURRENT</a></div><div class="ttdeci">#define AP_COMPASS_MOT_COMP_CURRENT</div><div class="ttdef"><b>Definition:</b> <a href="Compass_8h_source.html#l00025">Compass.h:25</a></div></div>
<div class="ttc" id="AP__Math__AVR__Compat_8h_html_ae31ff8b5990823ebb5d9746cc0843293"><div class="ttname"><a href="AP__Math__AVR__Compat_8h.html#ae31ff8b5990823ebb5d9746cc0843293">atan2f</a></div><div class="ttdeci">#define atan2f</div><div class="ttdef"><b>Definition:</b> <a href="AP__Math__AVR__Compat_8h_source.html#l00090">AP_Math_AVR_Compat.h:90</a></div></div>
<div class="ttc" id="classVector3_html"><div class="ttname"><a href="classVector3.html">Vector3&lt; float &gt;</a></div></div>
<div class="ttc" id="rotations_8h_html_a4940d1dc528122726d2c8c475657e1a9"><div class="ttname"><a href="rotations_8h.html#a4940d1dc528122726d2c8c475657e1a9">Rotation</a></div><div class="ttdeci">Rotation</div><div class="ttdoc">-*- tab-width: 4; Mode: C++; c-basic-offset: 4; indent-tabs-mode: nil -*- </div><div class="ttdef"><b>Definition:</b> <a href="rotations_8h_source.html#l00028">rotations.h:28</a></div></div>
<div class="ttc" id="classCompass_html_aeef734d2cd69c8c0c3efa182ec7f80bb"><div class="ttname"><a href="classCompass.html#aeef734d2cd69c8c0c3efa182ec7f80bb">Compass::calculate_heading</a></div><div class="ttdeci">float calculate_heading(const Matrix3f &amp;dcm_matrix) const </div><div class="ttdef"><b>Definition:</b> <a href="Compass_8cpp_source.html#l00495">Compass.cpp:495</a></div></div>
<div class="ttc" id="classCompass_html_aaea07d9da1c4836fdf1300845514e831"><div class="ttname"><a href="classCompass.html#aaea07d9da1c4836fdf1300845514e831">Compass::_last_update_usec</a></div><div class="ttdeci">uint32_t _last_update_usec</div><div class="ttdef"><b>Definition:</b> <a href="Compass_8h_source.html#l00258">Compass.h:258</a></div></div>
<div class="ttc" id="classCompass_html_abfc394b43272d5a6e97001232e201b7f"><div class="ttname"><a href="classCompass.html#abfc394b43272d5a6e97001232e201b7f">Compass::save_offsets</a></div><div class="ttdeci">void save_offsets(void)</div><div class="ttdef"><b>Definition:</b> <a href="Compass_8cpp_source.html#l00424">Compass.cpp:424</a></div></div>
<div class="ttc" id="AP__Progmem__AVR_8h_html_a05ca900ebf7cd121be73c654d9ccb3eb"><div class="ttname"><a href="AP__Progmem__AVR_8h.html#a05ca900ebf7cd121be73c654d9ccb3eb">PSTR</a></div><div class="ttdeci">#define PSTR(s)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Progmem__AVR_8h_source.html#l00028">AP_Progmem_AVR.h:28</a></div></div>
<div class="ttc" id="classCompass_html_ac3bf8f6ab108927b2ea704b3dcba1355"><div class="ttname"><a href="classCompass.html#ac3bf8f6ab108927b2ea704b3dcba1355">Compass::_backend_count</a></div><div class="ttdeci">uint8_t _backend_count</div><div class="ttdef"><b>Definition:</b> <a href="Compass_8h_source.html#l00262">Compass.h:262</a></div></div>
<div class="ttc" id="classCompass_html_a3c0f008f3766d88885b3c0893fe11d76"><div class="ttname"><a href="classCompass.html#a3c0f008f3766d88885b3c0893fe11d76">Compass::_hil</a></div><div class="ttdeci">struct Compass::@2 _hil</div></div>
<div class="ttc" id="classCompass_html_a1479c75532bc97308b1c698b67cf9bcc"><div class="ttname"><a href="classCompass.html#a1479c75532bc97308b1c698b67cf9bcc">Compass::configured</a></div><div class="ttdeci">bool configured(void)</div><div class="ttdef"><b>Definition:</b> <a href="Compass_8cpp_source.html#l00560">Compass.cpp:560</a></div></div>
<div class="ttc" id="AP__Param_8h_html_a0f9acb038a5283b964b862aea8cc5051"><div class="ttname"><a href="AP__Param_8h.html#a0f9acb038a5283b964b862aea8cc5051">AP_GROUPEND</a></div><div class="ttdeci">#define AP_GROUPEND</div><div class="ttdef"><b>Definition:</b> <a href="AP__Param_8h_source.html#l00053">AP_Param.h:53</a></div></div>
<div class="ttc" id="classCompass_html_aa953947e6a3d5acc0504e3f7c1e6b61d"><div class="ttname"><a href="classCompass.html#aa953947e6a3d5acc0504e3f7c1e6b61d">Compass::_state</a></div><div class="ttdeci">struct Compass::mag_state _state[COMPASS_MAX_INSTANCES]</div></div>
<div class="ttc" id="classCompass_html_a95d49517b12183412d9d0ed481b785bf"><div class="ttname"><a href="classCompass.html#a95d49517b12183412d9d0ed481b785bf">Compass::set_initial_location</a></div><div class="ttdeci">void set_initial_location(int32_t latitude, int32_t longitude)</div><div class="ttdef"><b>Definition:</b> <a href="Compass_8cpp_source.html#l00447">Compass.cpp:447</a></div></div>
<div class="ttc" id="classAP__HAL_1_1HAL_html_a94ab41309b1ff10b8b862b826e59c882"><div class="ttname"><a href="classAP__HAL_1_1HAL.html#a94ab41309b1ff10b8b862b826e59c882">AP_HAL::HAL::scheduler</a></div><div class="ttdeci">AP_HAL::Scheduler * scheduler</div><div class="ttdef"><b>Definition:</b> <a href="HAL_8h_source.html#l00065">HAL.h:65</a></div></div>
<div class="ttc" id="classVector3_html_a1a0f7e168c71ca798099f0ba8a444244"><div class="ttname"><a href="classVector3.html#a1a0f7e168c71ca798099f0ba8a444244">Vector3::x</a></div><div class="ttdeci">T x</div><div class="ttdef"><b>Definition:</b> <a href="vector3_8h_source.html#l00070">vector3.h:70</a></div></div>
<div class="ttc" id="classCompass_html_a1d376552464c5c5792326561d063ef7e"><div class="ttname"><a href="classCompass.html#a1d376552464c5c5792326561d063ef7e">Compass::_board_orientation</a></div><div class="ttdeci">enum Rotation _board_orientation</div><div class="ttdef"><b>Definition:</b> <a href="Compass_8h_source.html#l00271">Compass.h:271</a></div></div>
<div class="ttc" id="Compass_8h_html_aa61c5cc48785eef1f5b2143fa77a50e7"><div class="ttname"><a href="Compass_8h.html#aa61c5cc48785eef1f5b2143fa77a50e7">MAG_BOARD_ORIENTATION</a></div><div class="ttdeci">#define MAG_BOARD_ORIENTATION</div><div class="ttdef"><b>Definition:</b> <a href="Compass_8h_source.html#l00029">Compass.h:29</a></div></div>
<div class="ttc" id="structCompass_1_1mag__state_html_a90887b7c30ed529dc3fecfb36729f9d7"><div class="ttname"><a href="structCompass_1_1mag__state.html#a90887b7c30ed529dc3fecfb36729f9d7">Compass::mag_state::motor_compensation</a></div><div class="ttdeci">AP_Vector3f motor_compensation</div><div class="ttdef"><b>Definition:</b> <a href="Compass_8h_source.html#l00313">Compass.h:313</a></div></div>
<div class="ttc" id="rotations_8h_html_a4940d1dc528122726d2c8c475657e1a9a3c485d0686ff0555d4db0c22959f9dec"><div class="ttname"><a href="rotations_8h.html#a4940d1dc528122726d2c8c475657e1a9a3c485d0686ff0555d4db0c22959f9dec">ROTATION_NONE</a></div><div class="ttdef"><b>Definition:</b> <a href="rotations_8h_source.html#l00029">rotations.h:29</a></div></div>
<div class="ttc" id="classAP__Param_html_a5f6dcfce1c0a79cf5bd81283e22f3201"><div class="ttname"><a href="classAP__Param.html#a5f6dcfce1c0a79cf5bd81283e22f3201">AP_Param::setup_object_defaults</a></div><div class="ttdeci">static void setup_object_defaults(const void *object_pointer, const struct GroupInfo *group_info)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Param_8cpp_source.html#l00841">AP_Param.cpp:841</a></div></div>
<div class="ttc" id="classCompass_html_adeefda110ce0a02edfb3d344d632777a"><div class="ttname"><a href="classCompass.html#adeefda110ce0a02edfb3d344d632777a">Compass::save_motor_compensation</a></div><div class="ttdeci">void save_motor_compensation()</div><div class="ttdef"><b>Definition:</b> <a href="Compass_8cpp_source.html#l00438">Compass.cpp:438</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Feb 22 2016 15:25:20 for APM:Libraries by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
